<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <title>ch9</title>
      <style>html {font-size: 12px}.markdown-preview { font-family: 'Helvetica Neue', Helvetica, sans-serif; font-size: 14px; line-height: 1.6; overflow: scroll; box-sizing: border-box; padding: 20px; background-color: rgb(255, 255, 255); }
.markdown-preview code { color: rgb(51, 51, 51); }
.markdown-preview code, .markdown-preview tt, .markdown-preview pre.editor-colors { font-size: 12px; font-family: Consolas, 'Liberation Mono', Courier, monospace; }
.markdown-preview a, .markdown-preview a code { color: rgb(65, 131, 196); }
.markdown-preview ol > li { list-style-type: decimal; }
.markdown-preview ul > li { list-style-type: disc; }
.markdown-preview li > pre.editor-colors { display: inline-block; vertical-align: top; width: 100%; }
.markdown-preview li:last-child > pre.editor-colors { margin-bottom: 0px; }
.markdown-preview > :first-child { margin-top: 0px !important; }
.markdown-preview > :last-child { margin-bottom: 0px !important; }
.markdown-preview a.absent { color: rgb(204, 0, 0); }
.markdown-preview a.anchor { display: block; padding-left: 30px; margin-left: -30px; cursor: pointer; position: absolute; top: 0px; left: 0px; bottom: 0px; }
.markdown-preview h1, .markdown-preview h2, .markdown-preview h3, .markdown-preview h4, .markdown-preview h5, .markdown-preview h6 { font-family: 'Helvetica Neue', Helvetica, sans-serif; margin: 20px 0px 10px; padding: 0px 0px 10px; font-weight: bold; -webkit-font-smoothing: antialiased; cursor: text; position: relative; }
.markdown-preview h1 .octicon-link, .markdown-preview h2 .octicon-link, .markdown-preview h3 .octicon-link, .markdown-preview h4 .octicon-link, .markdown-preview h5 .octicon-link, .markdown-preview h6 .octicon-link { display: none; color: rgb(0, 0, 0); }
.markdown-preview h1:hover a.anchor, .markdown-preview h2:hover a.anchor, .markdown-preview h3:hover a.anchor, .markdown-preview h4:hover a.anchor, .markdown-preview h5:hover a.anchor, .markdown-preview h6:hover a.anchor { text-decoration: none; line-height: 1; padding-left: 0px; margin-left: -22px; top: 15%; }
.markdown-preview h1:hover a.anchor .octicon-link, .markdown-preview h2:hover a.anchor .octicon-link, .markdown-preview h3:hover a.anchor .octicon-link, .markdown-preview h4:hover a.anchor .octicon-link, .markdown-preview h5:hover a.anchor .octicon-link, .markdown-preview h6:hover a.anchor .octicon-link { display: inline-block; }
.markdown-preview h1 tt, .markdown-preview h2 tt, .markdown-preview h3 tt, .markdown-preview h4 tt, .markdown-preview h5 tt, .markdown-preview h6 tt, .markdown-preview h1 code, .markdown-preview h2 code, .markdown-preview h3 code, .markdown-preview h4 code, .markdown-preview h5 code, .markdown-preview h6 code { font-size: inherit; }
.markdown-preview h1 { font-size: 28px; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221); color: rgb(0, 0, 0); }
.markdown-preview h2 { font-size: 24px; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(0, 0, 0); }
.markdown-preview h3 { font-size: 18px; }
.markdown-preview h4 { font-size: 16px; }
.markdown-preview h5 { font-size: 14px; }
.markdown-preview h6 { color: rgb(119, 119, 119); font-size: 14px; }
.markdown-preview p, .markdown-preview blockquote, .markdown-preview ul, .markdown-preview ol, .markdown-preview dl, .markdown-preview table, .markdown-preview pre.editor-colors { margin: 15px 0px; }
.markdown-preview hr { border: 0px none; color: rgb(204, 204, 204); height: 4px; padding: 0px; margin: 15px 0px; background: url('data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC') 0px 0px repeat-x transparent; }
.markdown-preview > h2:first-child, .markdown-preview > h1:first-child, .markdown-preview > h1:first-child + h2, .markdown-preview > h3:first-child, .markdown-preview > h4:first-child, .markdown-preview > h5:first-child, .markdown-preview > h6:first-child { margin-top: 0px; padding-top: 0px; }
.markdown-preview a:first-child h1, .markdown-preview a:first-child h2, .markdown-preview a:first-child h3, .markdown-preview a:first-child h4, .markdown-preview a:first-child h5, .markdown-preview a:first-child h6 { margin-top: 0px; padding-top: 0px; }
.markdown-preview h1 + p, .markdown-preview h2 + p, .markdown-preview h3 + p, .markdown-preview h4 + p, .markdown-preview h5 + p, .markdown-preview h6 + p { margin-top: 0px; }
.markdown-preview li p.first { display: inline-block; }
.markdown-preview ul, .markdown-preview ol { padding-left: 30px; }
.markdown-preview ul.no-list, .markdown-preview ol.no-list { list-style-type: none; padding: 0px; }
.markdown-preview ul li > :first-child, .markdown-preview ol li > :first-child, .markdown-preview ul li ul:first-of-type, .markdown-preview ol li ul:first-of-type { margin-top: 0px; }
.markdown-preview ul ul, .markdown-preview ul ol, .markdown-preview ol ol, .markdown-preview ol ul { margin-bottom: 0px; }
.markdown-preview dl { padding: 0px; }
.markdown-preview dl dt { font-size: 14px; font-weight: bold; font-style: italic; padding: 0px; margin: 15px 0px 5px; }
.markdown-preview dl dt:first-child { padding: 0px; }
.markdown-preview dl dt > :first-child { margin-top: 0px; }
.markdown-preview dl dt > :last-child { margin-bottom: 0px; }
.markdown-preview dl dd { margin: 0px 0px 15px; padding: 0px 15px; }
.markdown-preview dl dd > :first-child { margin-top: 0px; }
.markdown-preview dl dd > :last-child { margin-bottom: 0px; }
.markdown-preview blockquote { border-left-width: 4px; border-left-style: solid; border-left-color: rgb(221, 221, 221); padding: 0px 15px; color: rgb(119, 119, 119); }
.markdown-preview blockquote > :first-child { margin-top: 0px; }
.markdown-preview blockquote > :last-child { margin-bottom: 0px; }
.markdown-preview blockquote p { font-size: 16px; line-height: 1.5; }
.markdown-preview table th { font-weight: bold; }
.markdown-preview table th, .markdown-preview table td { border: 1px solid rgb(204, 204, 204); padding: 6px 13px; }
.markdown-preview table tr { border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(255, 255, 255); }
.markdown-preview table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
.markdown-preview img { max-width: 100%; }
.markdown-preview span.frame { display: block; overflow: hidden; }
.markdown-preview span.frame > span { border: 1px solid rgb(221, 221, 221); display: block; float: left; overflow: hidden; margin: 13px 0px 0px; padding: 7px; width: auto; }
.markdown-preview span.frame span img { display: block; float: left; }
.markdown-preview span.frame span span { clear: both; color: rgb(51, 51, 51); display: block; padding: 5px 0px 0px; }
.markdown-preview span.align-center { display: block; overflow: hidden; clear: both; }
.markdown-preview span.align-center > span { display: block; overflow: hidden; margin: 13px auto 0px; text-align: center; }
.markdown-preview span.align-center span img { margin: 0px auto; text-align: center; }
.markdown-preview span.align-right { display: block; overflow: hidden; clear: both; }
.markdown-preview span.align-right > span { display: block; overflow: hidden; margin: 13px 0px 0px; text-align: right; }
.markdown-preview span.align-right span img { margin: 0px; text-align: right; }
.markdown-preview span.float-left { display: block; margin-right: 13px; overflow: hidden; float: left; }
.markdown-preview span.float-left span { margin: 13px 0px 0px; }
.markdown-preview span.float-right { display: block; margin-left: 13px; overflow: hidden; float: right; }
.markdown-preview span.float-right > span { display: block; overflow: hidden; margin: 13px auto 0px; text-align: right; }
.markdown-preview code, .markdown-preview tt { margin: 0px 2px; padding: 0px 5px; border: 1px solid rgb(234, 234, 234); border-radius: 3px; text-shadow: none; background-color: rgb(248, 248, 248); }
.markdown-preview pre.editor-colors { font-size: 13px; line-height: 19px; overflow: auto; padding: 6px 10px; border-radius: 3px; border: 1px solid rgb(224, 224, 225); background: rgb(250, 250, 250); }
.markdown-preview kbd { border-radius: 2px; border-width: 1px; border-style: solid; border-color: rgb(221, 221, 221) rgb(204, 204, 204) rgb(204, 204, 204) rgb(221, 221, 221); padding: 1px 4px; line-height: 10px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-image: linear-gradient(rgb(241, 241, 241), rgb(221, 221, 221)); background-color: rgb(221, 221, 221); background-repeat: repeat-x; }
.markdown-preview .emoji { height: 20px; width: 20px; }
.markdown-preview { font-size: 1.25em; color: rgb(80, 81, 83); background-color: rgb(255, 255, 255); }
.markdown-preview h1, .markdown-preview h2 { color: inherit; border-color: rgb(218, 219, 220); }
.markdown-preview a { color: rgb(20, 146, 255); }
.markdown-preview hr { background-color: rgb(255, 255, 255); }
.markdown-preview blockquote { color: rgb(80, 81, 83); border-left-color: rgba(80, 81, 83, 0.701961); }
.markdown-preview table th, .markdown-preview table td { border-color: rgb(218, 219, 220); }
.markdown-preview table th { background-color: rgb(255, 255, 255); }
.markdown-preview table tr { background-color: rgb(255, 255, 255); }
.markdown-preview table tr:nth-child(2n) { background-color: rgb(247, 247, 247); }
.markdown-preview code { color: rgb(104, 106, 110); border-color: rgb(218, 219, 220); background-color: rgb(247, 247, 247); background-clip: padding-box; }
.markdown-preview pre.editor-colors::shadow .line.cursor-line { background-color: transparent; }
.bracket-matcher .region {
  border-bottom: 1px dotted lime;
  position: absolute;
}

.spell-check-misspelling .region {
  border-bottom: 1px dashed rgba(250, 128, 114, 0.5);
}

pre.editor-colors,
.host {
  background-color: #fafafa;
  color: #545454;
}
pre.editor-colors .line.cursor-line,
.host .line.cursor-line {
  background-color: rgba(56, 75, 112, 0.07);
}
pre.editor-colors .invisible,
.host .invisible {
  color: #545454;
}
pre.editor-colors .cursor,
.host .cursor {
  border-left: 2px solid #528bff;
}
pre.editor-colors .selection .region,
.host .selection .region {
  background-color: #e5e5e6;
}
pre.editor-colors .bracket-matcher .region,
.host .bracket-matcher .region {
  border-bottom: 1px solid #528bff;
  box-sizing: border-box;
  background-color: #eaeaeb;
}
pre.editor-colors .invisible-character,
.host .invisible-character {
  color: rgba(84, 84, 84, 0.4);
}
pre.editor-colors .indent-guide,
.host .indent-guide {
  color: rgba(84, 84, 84, 0.4);
}
pre.editor-colors .wrap-guide,
.host .wrap-guide {
  background-color: rgba(84, 84, 84, 0.4);
}
pre.editor-colors .gutter .line-number,
.host .gutter .line-number {
  color: #969696;
  -webkit-font-smoothing: antialiased;
}
pre.editor-colors .gutter .line-number.git-line-removed:before,
.host .gutter .line-number.git-line-removed:before {
  bottom: -3px;
}
pre.editor-colors .gutter .line-number.git-line-removed:after,
.host .gutter .line-number.git-line-removed:after {
  content: "";
  position: absolute;
  left: 0px;
  bottom: 0px;
  width: 25px;
  border-bottom: 1px dotted rgba(255, 20, 20, 0.5);
  pointer-events: none;
}
pre.editor-colors .gutter .line-number.cursor-line,
.host .gutter .line-number.cursor-line {
  color: #545454;
  background-color: #efeff0;
}
pre.editor-colors .gutter .line-number.cursor-line-no-selection,
.host .gutter .line-number.cursor-line-no-selection {
  background-color: transparent;
}
pre.editor-colors .gutter .line-number .icon-right,
.host .gutter .line-number .icon-right {
  color: #545454;
}
pre.editor-colors .gutter .line-number .icon-right,
.host .gutter .line-number .icon-right {
  color: #545454;
}
pre.editor-colors .gutter .line-number.folded,
.host .gutter .line-number.folded,
pre.editor-colors .gutter .line-number:after,
.host .gutter .line-number:after,
pre.editor-colors .fold-marker:after,
.host .fold-marker:after {
  color: #545454;
}
.comment {
  color: #7b7b79;
  font-style: italic;
}
.entity.name.type {
  color: #a58a03;
}
.entity.other.inherited-class {
  color: #428b1c;
}
.keyword {
  color: #a71cce;
}
.keyword.control {
  color: #a71cce;
}
.keyword.operator {
  color: #545454;
}
.keyword.other.special-method {
  color: #1f51eb;
}
.keyword.other.unit {
  color: #893a01;
}
.storage {
  color: #a71cce;
}
.constant {
  color: #893a01;
}
.constant.character.escape {
  color: #0a8560;
}
.constant.numeric {
  color: #893a01;
}
.constant.other.color {
  color: #0a8560;
}
.constant.other.symbol {
  color: #0a8560;
}
.variable {
  color: #bf1212;
}
.variable.interpolation {
  color: #b81332;
}
.variable.parameter.function {
  color: #545454;
}
.invalid.illegal {
  background-color: #bf1212;
  color: #fafafa;
}
.string {
  color: #428b1c;
}
.string.regexp {
  color: #0a8560;
}
.string.other.link {
  color: #bf1212;
}
.punctuation.definition.comment {
  color: #7b7b79;
}
.punctuation.definition.parameters,
.punctuation.definition.array {
  color: #545454;
}
.punctuation.definition.heading,
.punctuation.definition.identity {
  color: #1f51eb;
}
.punctuation.definition.bold {
  color: #a58a03;
  font-weight: bold;
}
.punctuation.definition.italic {
  color: #a71cce;
  font-style: italic;
}
.punctuation.section.embedded {
  color: #b81332;
}
.support.class {
  color: #a58a03;
}
.support.function {
  color: #0a8560;
}
.support.function.any-method {
  color: #1f51eb;
}
.entity.name.function {
  color: #1f51eb;
}
.entity.name.class,
.entity.name.type.class {
  color: #a58a03;
}
.entity.name.section {
  color: #1f51eb;
}
.entity.name.tag {
  color: #bf1212;
}
.entity.other.attribute-name {
  color: #893a01;
}
.entity.other.attribute-name.id {
  color: #1f51eb;
}
.meta.class {
  color: #a58a03;
}
.meta.link {
  color: #893a01;
}
.meta.require {
  color: #1f51eb;
}
.meta.selector {
  color: #a71cce;
}
.meta.separator {
  background-color: #373b41;
  color: #545454;
}
.meta.tag {
  color: #545454;
}
.none {
  color: #545454;
}
.markup.bold {
  color: #893a01;
  font-weight: bold;
}
.markup.changed {
  color: #a71cce;
}
.markup.deleted {
  color: #bf1212;
}
.markup.italic {
  color: #a71cce;
  font-style: italic;
}
.markup.heading .punctuation.definition.heading {
  color: #1f51eb;
}
.markup.inserted {
  color: #428b1c;
}
.markup.list {
  color: #bf1212;
}
.markup.quote {
  color: #893a01;
}
.markup.raw.inline {
  color: #428b1c;
}
.source.gfm .markup {
  -webkit-font-smoothing: auto;
}
.source.gfm .markup.heading {
  color: #bf1212;
}
.source.gfm .markup.link {
  color: #1f51eb;
}
.source.gfm .link .entity {
  color: #0a8560;
}
.ruby.symbol > .punctuation {
  color: inherit;
}
</style>
  </head>
  <body class='markdown-preview'><h1 id="9-communication-service">9 Communication service</h1>
<p>We are going to be working on the repository that you have created up to this point. If you skipped
ahead, don&#39;t worry. You can clone the repository from its Github repository.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;&nbsp;git&nbsp;clone&nbsp;git@github.com:skafandri/symfony-tutorial.git&nbsp;--branch&nbsp;ch8</span></span></div><div class="line"><span class="source shell"><span>Cloning&nbsp;into&nbsp;</span><span class="string quoted single shell"><span class="punctuation definition string begin shell"><span>&#39;</span></span><span>symfony-tutorial</span><span class="punctuation definition string end shell"><span>&#39;</span></span></span><span>...</span></span></div><div class="line"><span class="source shell"><span>remote:&nbsp;Counting&nbsp;objects:&nbsp;838,&nbsp;</span><span class="keyword control shell"><span>done</span></span><span>.</span></span></div><div class="line"><span class="source shell"><span>remote:&nbsp;Compressing&nbsp;objects:&nbsp;100%&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>93/93</span><span class="punctuation definition subshell shell"><span>)</span></span></span><span>,&nbsp;</span><span class="keyword control shell"><span>done</span></span><span>.</span></span></div><div class="line"><span class="source shell"><span>remote:&nbsp;Total&nbsp;838&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>delta&nbsp;27</span><span class="punctuation definition subshell shell"><span>)</span></span></span><span>,&nbsp;reused&nbsp;0&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>delta&nbsp;0</span><span class="punctuation definition subshell shell"><span>)</span></span></span><span>,&nbsp;pack-reused&nbsp;737</span></span></div><div class="line"><span class="source shell"><span>Receiving&nbsp;objects:&nbsp;100%&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>838/838</span><span class="punctuation definition subshell shell"><span>)</span></span></span><span>,&nbsp;433.96&nbsp;KiB&nbsp;</span><span class="keyword operator pipe shell"><span>|</span></span><span>&nbsp;319.00&nbsp;KiB/s,&nbsp;</span><span class="keyword control shell"><span>done</span></span><span>.</span></span></div><div class="line"><span class="source shell"><span>Resolving&nbsp;deltas:&nbsp;100%&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>405/405</span><span class="punctuation definition subshell shell"><span>)</span></span></span><span>,&nbsp;</span><span class="keyword control shell"><span>done</span></span><span>.</span></span></div><div class="line"><span class="source shell"><span>Checking&nbsp;connectivity...&nbsp;</span><span class="keyword control shell"><span>done</span></span><span>.</span></span></div></pre>
<p>Don&#39;t forget to <code>composer install</code></p>
<p>Make sure the Elasticsearch server and Kibana we installed last time are running, so we can easily view the generated logs.</p>
<p><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br></p>
<h2 id="9-1-extra-data-fixtures">9.1 Extra data fixtures</h2>
<p>Before proceeding with further functionality implementation, we will add some data fixtures.</p>
<ul>
<li>Edit <strong>src/AppBundle/DataFixtures/ORM/AbstractDataFixture.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Doctrine</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Common</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>AbstractFixture</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Doctrine</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Common</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>OrderedFixtureInterface</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Doctrine</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Common</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Persistence</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ObjectManager</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage modifier abstract php"><span>abstract</span></span><span>&nbsp;</span><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>AbstractDataFixture</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier implements php"><span>implements</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>OrderedFixtureInterface</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;ObjectManager</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>manager</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>load</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>ObjectManager</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>manager</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>manager</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>createAndPersistData</span></span><span>(</span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>flush</span></span><span>(</span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>abstract</span></span><span>&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getReferences</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>prefix</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>entities</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="meta array empty php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="punctuation definition array end php"><span>)</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>for</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="constant language php"><span>true</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span class="keyword operator increment-decrement php"><span>++</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control exception php"><span>try</span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>entities</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getReference</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>%s_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>prefix</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span><span>&nbsp;</span><span class="meta catch php"><span class="keyword control exception catch php"><span>catch</span></span><span>&nbsp;(</span><span class="support other namespace php"><span class="punctuation separator inheritance php"><span>\</span></span></span><span class="support class exception php"><span>OutOfBoundsException</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>exception</span></span><span>)</span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>break</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>entities</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br><br><br></p>
<ul>
<li>Edit <strong>src/AppBundle/DataFixtures/ORM/CategoryFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Category</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>CategoryFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>categoriesCount</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>0</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>categories</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>computers</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>servers</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>desktop</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>laptops</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>components</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>periferals</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation definition array end php"><span>)</span></span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>phones&nbsp;and&nbsp;tablets</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>phones</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>tablets</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>accessories</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation definition array end php"><span>)</span></span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>appliances</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>coffe&nbsp;machines</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>washing&nbsp;machines</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>blenders</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>juicers</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation definition array end php"><span>)</span></span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>video&nbsp;games</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>consoles</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>games</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>accessories</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation definition array end php"><span>)</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition array end php"><span>)</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>foreach</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>categories</span></span><span>&nbsp;</span><span class="keyword operator logical php"><span>as</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parent</span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>children</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parentCategory</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>createAndPersistCategory</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parent</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>foreach</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>children</span></span><span>&nbsp;</span><span class="keyword operator logical php"><span>as</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>label</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>createAndPersistCategory</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>label</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parentCategory</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistCategory</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>label</span></span></span><span>,</span><span class="meta function argument default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parentCategory</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>null</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>categoriesCount</span></span><span>&nbsp;</span><span class="keyword operator increment-decrement php"><span>++</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Category</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setLabel</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>label</span></span><span>)</span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setParentCategory</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parentCategory</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setReference</span></span><span>(</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>category_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>categoriesCount</span></span><span>),&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br></p>
<ul>
<li>Edit <strong>src/AppBundle/DataFixtures/ORM/ProductFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Category</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Product</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DependencyInjection</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ContainerAwareInterface</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DependencyInjection</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ContainerInterface</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>ProductFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span><span>&nbsp;</span><span class="storage modifier implements php"><span>implements</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>ContainerAwareInterface</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productsCount</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>0</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productsPerCategory</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistProducts</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>Category</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>for</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator comparison php"><span>&lt;=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>productsPerCategory</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span class="keyword operator increment-decrement php"><span>++</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>productsCount</span></span><span class="keyword operator increment-decrement php"><span>++</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>product</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Product</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>product</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setCode</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>code_%s_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getId</span></span><span>(</span><span>),&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>))</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setTitle</span></span><span>(</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>title&nbsp;%s&nbsp;%s&nbsp;%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getId</span></span><span>(</span><span>),&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>,&nbsp;</span><span class="support function basic_functions php"><span>uniqid</span></span><span>())</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setDescription</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>product&nbsp;description&nbsp;%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>addProduct</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>product</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>product</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setReference</span></span><span>(</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>product_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>productsCount</span></span><span>),&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>product</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>foreach</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getReferences</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>category</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)&nbsp;</span><span class="keyword operator logical php"><span>as</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>createAndPersistProducts</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>category</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setContainer</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>ContainerInterface</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>container</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>null</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>fixturesConfig</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>container</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getParameter</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>fixtures</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>productsPerCategory</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>fixturesConfig</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>products_per_category</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>2</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Create <strong>src/AppBundle/DataFixtures/ORM/AccountFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Account</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>AccountFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>ACCOUNTS_COUNT</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>10</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>for</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator comparison php"><span>&lt;=</span></span><span>&nbsp;</span><span class="storage type php"><span>self</span></span><span class="keyword operator class php"><span>::</span></span><span class="constant other class php"><span>ACCOUNTS_COUNT</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span class="keyword operator increment-decrement php"><span>++</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>account</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Account</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>account</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setActive</span></span><span>(</span><span class="constant language php"><span>true</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>account</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setEmail</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>email%s@email.com</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>account</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setPassword</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>password</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>account</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setReference</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>account_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>),&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>account</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br></p>
<ul>
<li>Create <strong>src/AppBundle/DataFixtures/ORM/ContactFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Contact</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>ContactFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>CONTACTS_COUNT</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>10</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>for</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator comparison php"><span>&lt;=</span></span><span>&nbsp;</span><span class="storage type php"><span>self</span></span><span class="keyword operator class php"><span>::</span></span><span class="constant other class php"><span>CONTACTS_COUNT</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span class="keyword operator increment-decrement php"><span>++</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>contact</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Contact</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>contact</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setName</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>contact&nbsp;%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>contact</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setEmail</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>contact_email%s@email.com</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>contact</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setMobilePhone</span></span><span>(</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="constant numeric php"><span>1111111111</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>9999999999</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>contact</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setPhone</span></span><span>(</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="constant numeric php"><span>1111111111</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>9999999999</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>contact</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setReference</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>contact_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>),&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>contact</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br></p>
<ul>
<li>Create <strong>src/AppBundle/DataFixtures/ORM/CountryFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Country</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>CountryFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>countries</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>en</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>england</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>es</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>spain</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>fr</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>france</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>it</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>italy</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>ro</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>romania</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>tn</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>tunisia</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition array end php"><span>)</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>foreach</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>countries</span></span><span>&nbsp;</span><span class="keyword operator logical php"><span>as</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>countryCode</span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>name</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>country</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Country</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>country</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setCode</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>countryCode</span></span><span>)</span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setName</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>name</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>country</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<ul>
<li>Create <strong>src/AppBundle/DataFixtures/ORM/CustomerFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Customer</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>CustomerFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>index</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>0</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>foreach</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getReferences</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>account</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)&nbsp;</span><span class="keyword operator logical php"><span>as</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>account</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>index</span></span><span class="keyword operator increment-decrement php"><span>++</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>contact</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getReference</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>contact_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>index</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>customer</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Customer</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>customer</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setAccount</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>account</span></span><span>)</span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setContact</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>contact</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>customer</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>2</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Create <strong>src/AppBundle/DataFixtures/ORM/ProductSaleFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ProductSale</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>ProductSaleFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>foreach</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getReferences</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>product</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)&nbsp;</span><span class="keyword operator logical php"><span>as</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>product</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productSale</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>ProductSale</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productSale</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setProduct</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>product</span></span><span>)</span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setActive</span></span><span>(</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="constant numeric php"><span>0</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>1</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productSale</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setPrice</span></span><span>(</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="constant numeric php"><span>100</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>10000</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>randomDate</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="support function datetime php"><span>time</span></span><span>()&nbsp;</span><span class="keyword operator arithmetic php"><span>+</span></span><span>&nbsp;</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="keyword operator arithmetic php"><span>-</span></span><span class="constant numeric php"><span>100000</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>100000</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>startDate</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class builtin php"><span class="punctuation separator inheritance php"><span>\</span></span><span>DateTime</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>startDate</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setTimestamp</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>randomDate</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>endDate</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class builtin php"><span class="punctuation separator inheritance php"><span>\</span></span><span>DateTime</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>endDate</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setTimestamp</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>randomDate</span></span><span>&nbsp;</span><span class="keyword operator arithmetic php"><span>+</span></span><span>&nbsp;</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="constant numeric php"><span>100000</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>1000000</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productSale</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setStartDate</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>startDate</span></span><span>)</span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setEndDate</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>endDate</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productSale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>3</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Create <strong>src/AppBundle/DataFixtures/ORM/ProductStockFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ProductStock</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>ProductStockFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>foreach</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getReferences</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>product</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)&nbsp;</span><span class="keyword operator logical php"><span>as</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>product</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productStock</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>ProductStock</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productStock</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setProduct</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>product</span></span><span>)</span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setQuantity</span></span><span>(</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="constant numeric php"><span>0</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>1000</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>warehouse</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getReference</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>warehouse_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="constant numeric php"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>10</span></span><span>)))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productStock</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setWarehouse</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>warehouse</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>productStock</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>3</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Create <strong>src/AppBundle/DataFixtures/ORM/VendorFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Vendor</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>VendorFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>for</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator comparison php"><span>&lt;=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>10</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span class="keyword operator increment-decrement php"><span>++</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>vendor</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Vendor</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>vendor</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setName</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>vendor_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>vendor</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Create <strong>src/AppBundle/DataFixtures/ORM/WarehouseFixtures.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DataFixtures</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Warehouse</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>WarehouseFixtures</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>AbstractDataFixture</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>protected</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>createAndPersistData</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>for</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>&nbsp;</span><span class="keyword operator comparison php"><span>&lt;=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>10</span></span><span class="punctuation terminator expression php"><span>;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span class="keyword operator increment-decrement php"><span>++</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>warehouse</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Warehouse</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>warehouse</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setName</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>warehouse_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>warehouse</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setAddress</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>warehouse&nbsp;address&nbsp;%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>warehouse</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setReference</span></span><span>(</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>warehouse_%s</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>i</span></span><span>),&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>warehouse</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getOrder</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p>Done, now we can load the new fixtures into the database</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;app/console&nbsp;doctrine:schema:drop&nbsp;--force</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Dropping&nbsp;database&nbsp;schema...</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Database&nbsp;schema&nbsp;dropped&nbsp;successfully!</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;app/console&nbsp;doctrine:schema:create</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>ATTENTION:&nbsp;This&nbsp;operation&nbsp;should&nbsp;not&nbsp;be&nbsp;executed&nbsp;in&nbsp;a&nbsp;production&nbsp;environment.</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Creating&nbsp;database&nbsp;schema...</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Database&nbsp;schema&nbsp;created&nbsp;successfully!</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;app/console&nbsp;doctrine:fixtures:load</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Careful,&nbsp;database&nbsp;will&nbsp;be&nbsp;purged.&nbsp;Do&nbsp;you&nbsp;want&nbsp;to&nbsp;continue&nbsp;Y/N&nbsp;?y</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;</span><span class="meta paragraph text"><span>&gt;&nbsp;purging&nbsp;database</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[1]&nbsp;AppBundle\DataFixtures\ORM\ContactFixtures</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[1]&nbsp;AppBundle\DataFixtures\ORM\VendorFixtures</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[1]&nbsp;AppBundle\DataFixtures\ORM\AccountFixtures</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[1]&nbsp;AppBundle\DataFixtures\ORM\WarehouseFixtures</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[1]&nbsp;AppBundle\DataFixtures\ORM\CategoryFixtures</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[1]&nbsp;AppBundle\DataFixtures\ORM\CountryFixtures</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[2]&nbsp;AppBundle\DataFixtures\ORM\CustomerFixtures</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[2]&nbsp;AppBundle\DataFixtures\ORM\ProductFixtures</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[3]&nbsp;AppBundle\DataFixtures\ORM\ProductSaleFixtures</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&gt;&nbsp;loading&nbsp;[3]&nbsp;AppBundle\DataFixtures\ORM\ProductStockFixtures</span></span></span></div></pre><h2 id="9-2-send-confirmation-email-to-customer">9.2 Send confirmation email to customer</h2>
<p>We are going to implement the emails sending logic. We will use a mixture of Twig templates and translation files to render the email HTML.</p>
<p>First, we have a small bug to fix.</p>
<ul>
<li><p>Edit  <strong>src/AppBundle/Service/Communication/EmailService.php</strong> and change<br><code>$provider = $this-&gt;providerIndex[$this-&gt;providerIndex];</code><br>to<br><code>$provider = $this-&gt;providers[$this-&gt;providerIndex];</code></p>
</li>
<li><p>Create <strong>src/AppBundle/Resources/views/Templates/Email/base.html.twig</strong></p>
</li>
</ul>
<pre class="editor-colors lang-html"><div class="line"><span class="text html basic"><span class="meta tag sgml html"><span class="punctuation definition tag html"><span>&lt;!</span></span><span class="meta tag sgml doctype html"><span>DOCTYPE</span><span>&nbsp;html</span></span><span class="punctuation definition tag html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span class="meta tag structure any html"><span class="punctuation definition tag html"><span>&lt;</span></span><span class="entity name tag structure any html"><span>html</span></span><span class="punctuation definition tag html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag structure any html"><span class="punctuation definition tag html"><span>&lt;</span></span><span class="entity name tag structure any html"><span>head</span></span><span class="punctuation definition tag html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag inline any html"><span>meta</span></span><span>&nbsp;</span><span class="entity other attribute-name html"><span>charset</span></span><span>=</span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span>UTF-8</span><span class="punctuation definition string end html"><span>&quot;</span></span></span><span class="punctuation definition tag end html"><span>&nbsp;/&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag inline any html"><span>title</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;block&nbsp;title&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;if&nbsp;title&nbsp;is&nbsp;defined&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{title|trans}}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;endif&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;endblock&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag inline any html"><span>title</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag structure any html"><span class="punctuation definition tag html"><span>&lt;/</span></span><span class="entity name tag structure any html"><span>head</span></span><span class="punctuation definition tag html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag structure any html"><span class="punctuation definition tag html"><span>&lt;</span></span><span class="entity name tag structure any html"><span>body</span></span><span class="punctuation definition tag html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;block&nbsp;body&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag block any html"><span>div</span></span><span>&nbsp;</span><span class="meta attribute-with-value id html"><span class="entity other attribute-name id html"><span>id</span></span><span class="punctuation separator key-value html"><span>=</span></span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span class="meta toc-list id html"><span>container</span></span><span class="punctuation definition string end html"><span>&quot;</span></span></span></span><span>&nbsp;</span><span class="entity other attribute-name html"><span>style</span></span><span>=</span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span>width:&nbsp;600px</span><span class="punctuation definition string end html"><span>&quot;</span></span></span><span>&nbsp;</span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag block any html"><span>div</span></span><span>&nbsp;</span><span class="meta attribute-with-value id html"><span class="entity other attribute-name id html"><span>id</span></span><span class="punctuation separator key-value html"><span>=</span></span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span class="meta toc-list id html"><span>header</span></span><span class="punctuation definition string end html"><span>&quot;</span></span></span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;block&nbsp;header&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag block any html"><span>h1</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span><span>&nbsp;{{&nbsp;&#39;company_name&#39;|trans|capitalize&nbsp;}}</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag block any html"><span>h1</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;endblock&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag block any html"><span>div</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag block any html"><span>div</span></span><span>&nbsp;</span><span class="meta attribute-with-value id html"><span class="entity other attribute-name id html"><span>id</span></span><span class="punctuation separator key-value html"><span>=</span></span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span class="meta toc-list id html"><span>content</span></span><span class="punctuation definition string end html"><span>&quot;</span></span></span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;block&nbsp;content&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;endblock&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag block any html"><span>div</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag block any html"><span>div</span></span><span>&nbsp;</span><span class="meta attribute-with-value id html"><span class="entity other attribute-name id html"><span>id</span></span><span class="punctuation separator key-value html"><span>=</span></span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span class="meta toc-list id html"><span>footer</span></span><span class="punctuation definition string end html"><span>&quot;</span></span></span></span><span>&nbsp;</span><span class="entity other attribute-name html"><span>style</span></span><span>=</span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span>font-size:&nbsp;10px</span><span class="punctuation definition string end html"><span>&quot;</span></span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;block&nbsp;footer&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag block any html"><span>hr</span></span><span>/</span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{&nbsp;&#39;copyright&#39;|trans|capitalize&nbsp;}}&nbsp;{{&nbsp;&quot;now&quot;|date(&quot;Y&quot;)&nbsp;}}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{&nbsp;&#39;company_name&#39;|trans}}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;endblock&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag block any html"><span>div</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag block any html"><span>div</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;endblock&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag structure any html"><span class="punctuation definition tag html"><span>&lt;/</span></span><span class="entity name tag structure any html"><span>body</span></span><span class="punctuation definition tag html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span class="meta tag structure any html"><span class="punctuation definition tag html"><span>&lt;/</span></span><span class="entity name tag structure any html"><span>html</span></span><span class="punctuation definition tag html"><span>&gt;</span></span></span></span></div></pre>
<p><br></p>
<ul>
<li>Create <strong>src/AppBundle/Resources/views/Templates/Email/confirmation.html.twig</strong></li>
</ul>
<pre class="editor-colors lang-html"><div class="line"><span class="text html basic"><span>{%&nbsp;extends&nbsp;&#39;AppBundle:Templates:Email/base.html.twig&#39;&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;</span></span></div><div class="line"><span class="text html basic"><span>{%&nbsp;block&nbsp;content&nbsp;%}</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;{{&nbsp;&#39;confirmation.text&#39;|trans(</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&#39;%customerName%&#39;:&nbsp;customerName,&nbsp;&#39;%orderNumber%&#39;:&nbsp;orderNumber},</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;email&#39;</span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;}}</span></span></div><div class="line"><span class="text html basic"><span>{%&nbsp;endblock&nbsp;%}</span></span></div></pre>
<ul>
<li>Edit <strong>src/AppBundle/Resources/translations/messages.en.yml</strong></li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>order:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>status:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>1:&nbsp;new</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10:&nbsp;processing</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11:&nbsp;products&nbsp;missing</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14:&nbsp;products&nbsp;reserved</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15:&nbsp;packaging</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20:&nbsp;delivery&nbsp;started</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29:&nbsp;delivered</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30:&nbsp;cancelled</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>copyright:&nbsp;copyright</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>company_name:&nbsp;the&nbsp;company</span></span></span></div></pre><ul>
<li>Create <strong>src/AppBundle/Resources/translations/email.en.yml</strong></li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>confirmation:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>text:&nbsp;Thank&nbsp;you&nbsp;%customerName%,&nbsp;your&nbsp;order&nbsp;number</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>%orderNumber%&nbsp;is&nbsp;being&nbsp;processed.</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>subject:&nbsp;Order&nbsp;confirmation</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;orders@site.com</span></span></span></div></pre><p>We forgot to add a <strong>from</strong> field to our email Message. Edit <strong>src/AppBundle/Communication/Email/Message.php</strong> to add the <strong>from</strong> member and it&#39;s accessors.</p>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span>private&nbsp;$from;</span></span></div><div class="line"><span class="text html php"><span>...</span></span></div><div class="line"><span class="text html php"><span>public&nbsp;function&nbsp;getFrom()</span></span></div><div class="line"><span class="text html php"><span>{</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;from;</span></span></div><div class="line"><span class="text html php"><span>}</span></span></div><div class="line"><span class="text html php"><span>&nbsp;</span></span></div><div class="line"><span class="text html php"><span>public&nbsp;function&nbsp;setFrom($from)</span></span></div><div class="line"><span class="text html php"><span>{</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;from&nbsp;=&nbsp;$from;</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this;</span></span></div><div class="line"><span class="text html php"><span>}</span></span></div></pre>
<p>Let&#39;s create some new events related to email sending</p>
<ul>
<li>Create <strong>src/AppBundle/Event/Communication/Email/EmailEvent.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Event</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Event</span><span class="punctuation separator inheritance php"><span>\</span></span><span>LoggableEventInterface</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>EventDispatcher</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Event</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>EmailEvent</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>Event</span></span></span><span>&nbsp;</span><span class="storage modifier implements php"><span>implements</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>LoggableEventInterface</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>BEFORE_SEND</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>email.before_send</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>ERROR_TEMPORARY</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>email.error_temporary</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>ERROR_PERMANENT</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>email.error_permanent</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>SENT</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>email.sent</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="support function magic php"><span>__construct</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>type</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>emailAddress</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>arguments</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getLogContext</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>type</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>type</span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>emailAddress</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>emailAddress</span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>arguments</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>arguments</span></span><span>,</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition array end php"><span>)</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getType</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>type</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getEmailAddress</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>emailAddress</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getArguments</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>arguments</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br></p>
<ul>
<li>Create <strong>src/AppBundle/Event/Communication/Email/EmailSendingEvent.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Event</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Message</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>EmailSendingEvent</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>EmailEvent</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;Message</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="support function magic php"><span>__construct</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span><span>,&nbsp;</span><span class="meta function argument typehinted php"><span class="support class php"><span>Message</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type php"><span>parent</span></span><span class="keyword operator class php"><span>::</span></span><span class="meta function-call static php"><span>__construct</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getTo</span></span><span>(</span><span>),&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>message</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getLogContext</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>context</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>from</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getFrom</span></span><span>(</span><span class="punctuation definition array end php"><span>)</span></span></span><span>,</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>subject</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getSubject</span></span><span>(</span><span>),</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>body</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getMessage</span></span><span>(</span><span>)</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="support function array php"><span>array_merge</span></span><span>(</span><span class="storage type php"><span>parent</span></span><span class="keyword operator class php"><span>::</span></span><span class="meta function-call static php"><span>getLogContext</span></span><span>(</span><span>),&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>context</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getMessage</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>message</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br></p>
<p>We will update the CommunicationService to require 3 new dependencies, a template renderer, a translator, and an event dispatcher.</p>
<p><br><br><br><br><br><br></p>
<ul>
<li>Edit <strong>src/AppBundle/Service/Communication/CommunicationService.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Service</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Message</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Event</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span><span class="punctuation separator inheritance php"><span>\</span></span><span>EmailEvent</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Event</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span><span class="punctuation separator inheritance php"><span>\</span></span><span>EmailSendingEvent</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>EventDispatcher</span><span class="punctuation separator inheritance php"><span>\</span></span><span>EventDispatcherInterface</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Templating</span><span class="punctuation separator inheritance php"><span>\</span></span><span>EngineInterface</span></span><span>&nbsp;</span><span class="keyword other use-as php"><span>as</span></span><span>&nbsp;</span><span class="support other namespace use-as php"><span>Templating</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Translation</span><span class="punctuation separator inheritance php"><span>\</span></span><span>TranslatorInterface</span></span><span>&nbsp;</span><span class="keyword other use-as php"><span>as</span></span><span>&nbsp;</span><span class="support other namespace use-as php"><span>Translator</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>CommunicationService</span></span><span>&nbsp;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>ID</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>app.communication</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;EmailService</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailService</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;Templating</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>twigEngine</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;Translator</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translator</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;EventDispatcherInterface</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>eventDispatcher</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="support function magic php"><span>__construct</span></span><span class="punctuation definition parameters begin php"><span>(</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span class="meta function arguments php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function argument typehinted php"><span class="support class php"><span>EmailService</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailService</span></span></span><span>,</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span class="meta function arguments php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function argument typehinted php"><span class="support class php"><span>Templating</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>twigEngine</span></span></span><span>,</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span class="meta function arguments php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function argument typehinted php"><span class="support class php"><span>Translator</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translator</span></span></span><span>,</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span class="meta function arguments php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function argument typehinted php"><span class="support class php"><span>EventDispatcherInterface</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>eventDispatcher</span></span><span>&nbsp;</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span class="meta function arguments php"><span class="meta function argument typehinted php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>emailService</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailService</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>twigEngine</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>twigEngine</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translator</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>eventDispatcher</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>eventDispatcher</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>sendConfirmationEmail</span></span><span class="punctuation definition parameters begin php"><span>(</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span class="meta function arguments php"><span class="meta function argument no-default php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span></span><span>,</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span class="meta function arguments php"><span class="meta function argument no-default php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>name</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>orderNumber</span></span></span><span>,</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span class="meta function arguments php"><span class="meta function argument default php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>en</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span class="meta function arguments php"><span class="meta function argument default php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>customerName</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>name</span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>orderNumber</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>orderNumber</span></span><span class="punctuation definition array end php"><span>)</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>sendEmail</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>confirmation</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>sendDeliveryEmail</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>orderNumber</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>sendInvoice</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>orderNumber</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>sendSatisfactionSurvey</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>orderNumber</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>sendEmail</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span><span>,</span><span class="meta function argument default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>en</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>eventDispatcher</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>dispatch</span></span><span>(</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support class php"><span>EmailEvent</span></span><span class="keyword operator class php"><span>::</span></span><span class="constant other class php"><span>BEFORE_SEND</span></span><span>,&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>EmailEvent</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>)</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setLocale</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>constructEmailMessage</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>status</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>emailService</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>send</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>dispatchEmailSendingEvent</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>status</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>status</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>dispatchEmailSendingEvent</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>status</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>EmailSendingEvent</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>eventDispatcher</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>dispatch</span></span><span>(</span><span class="support class php"><span>EmailSendingEvent</span></span><span class="keyword operator class php"><span>::</span></span><span class="constant other class php"><span>SENT</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>renderTempalate</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>templateName</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>AppBundle:Templates:Email/%s.html.twig</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>twigEngine</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>render</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>templateName</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getSubject</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translationKey</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>%s.subject</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>trans</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translationKey</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>email</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getFrom</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translationKey</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="support function string php"><span>sprintf</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>%s.from</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>trans</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translationKey</span></span><span>,&nbsp;</span><span class="meta array empty php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="punctuation definition array end php"><span>)</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>email</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>constructEmailMessage</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Message</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setTo</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setMessage</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>renderTempalate</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setSubject</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getSubject</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setFrom</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getFrom</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br></p>
<p>Now we need to update the service defintion to inject the new dependencies.</p>
<ul>
<li>Edit <strong>src/AppBundle/Resources/config/services.yml</strong> and upadte <strong>app.communication.arguments</strong> <code>arguments: [@app.email, @templating, @translator, @event_dispatcher]</code></li>
</ul>
<p><br></p>
<p>Since we changed <em>sendConfirmationEmail</em> in CommunicationServie, we need to change the call in OrderCommunicationListener</p>
<ul>
<li>Edit <strong>src/AppBundle/Event/Listener/OrderCommunicationListener.php</strong><br>Update <em>onAfterCreate</em> and add <em>getCustomerName</em> method</li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span>public&nbsp;function&nbsp;onAfterCreate(OrderEvent&nbsp;$event)</span></span></div><div class="line"><span class="text html php"><span>{</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;$emailAddress&nbsp;=&nbsp;$this-&gt;getEmailAddress($event);</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;$customerName&nbsp;=&nbsp;$this-&gt;getCustomerName($event);</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;communicationService-&gt;sendConfirmationEmail(</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$emailAddress,&nbsp;$customerName,&nbsp;$event-&gt;getOrder()-&gt;getId()</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;);</span></span></div><div class="line"><span class="text html php"><span>}</span></span></div><div class="line"><span class="text html php"><span>&nbsp;</span></span></div><div class="line"><span class="text html php"><span>private&nbsp;function&nbsp;getCustomerName(OrderEvent&nbsp;$event)</span></span></div><div class="line"><span class="text html php"><span>{</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$event-&gt;getOrder()-&gt;getCustomer()-&gt;getContact()-&gt;getName();</span></span></div><div class="line"><span class="text html php"><span>}</span></span></div></pre>
<p><br><br><br><br></p>
<p>Done. Try to create an order through the JSON-RPC API. You should see new logs about the email sending.</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>[]&nbsp;app.INFO:&nbsp;email.before_send&nbsp;{&quot;type&quot;:&quot;confirmation&quot;,&quot;emailAddress&quot;:</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&quot;contact_email1@email.com&quot;,&quot;arguments&quot;:{&quot;customerName&quot;:&quot;contact1&quot;,&quot;orderNumber&quot;:1}}[]</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>[]&nbsp;app.INFO:&nbsp;email.sent&nbsp;{&quot;type&quot;:&quot;confirmation&quot;,&quot;emailAddress&quot;:</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&quot;contact_email1@email.com&quot;,&quot;arguments&quot;:{&quot;customerName&quot;:&quot;contact1&quot;,&quot;orderNumber&quot;:1},</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&quot;from&quot;:&quot;orders@site.com&quot;,&quot;subject&quot;:&nbsp;&quot;Order&nbsp;confirmation&quot;,&quot;body&quot;:&quot;&lt;!DOCTYPE&nbsp;html&gt;\n</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&lt;html&gt;\n&nbsp;&nbsp;&lt;head&gt;\n&lt;meta&nbsp;charset=\&quot;UTF-8\&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;\n&nbsp;&nbsp;&lt;/title&gt;\n&nbsp;&lt;/head&gt;\n</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;</span><span class="meta paragraph text"><span>&lt;body&gt;\n&lt;div&nbsp;id=\&quot;container\&quot;&nbsp;style=\&quot;width:&nbsp;600px\&quot;&nbsp;&gt;\n&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=\&quot;header\&quot;&gt;\n</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&lt;h1&gt;&nbsp;The&nbsp;company&lt;/h1&gt;\n&lt;/div&gt;\n&nbsp;&lt;div&nbsp;id=\&quot;content\&quot;&gt;\nThank&nbsp;you&nbsp;contact1,</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>your&nbsp;order&nbsp;number&nbsp;1&nbsp;is&nbsp;being&nbsp;processed.\n&nbsp;&lt;/div&gt;\n</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&lt;div&nbsp;id=\&quot;footer\&quot;&nbsp;style=\&quot;font-size:&nbsp;10px\&quot;&gt;\n&lt;hr/&gt;\n</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span><span class="meta paragraph text"><span>Copyright&nbsp;2015&nbsp;the&nbsp;company\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;\n&nbsp;&nbsp;&lt;/body&gt;\n&lt;/html&gt;&quot;}&nbsp;[]</span></span></span></div></pre><p><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br></p>
<h2 id="9-3-mongodb">9.3 MongoDB</h2>
<p>Previously, we logged an entry that looks like:</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>{</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>&quot;type&quot;:&nbsp;&quot;confirmation&quot;,</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;emailAddress&quot;:&nbsp;&quot;contact_email1@email.com&quot;,</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;arguments&quot;:&nbsp;{</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>&quot;customerName&quot;:&nbsp;&quot;contact&nbsp;1&quot;,</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;orderNumber&quot;:&nbsp;29</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>},</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;from&quot;:&nbsp;&quot;orders@site.com&quot;,</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;subject&quot;:&nbsp;&quot;Order&nbsp;confirmation&quot;,</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;body&quot;:&nbsp;&quot;...&quot;</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>}</span></span></span></div></pre><p>We want to store this data in a searcheable format and eventually display it to an end user. An RDMS would be a good option for us, MySQL for instance since we are already using it, but..</p>
<ul>
<li>The <strong>body</strong> column can hold large data (is a HTML page)</li>
<li>We don&#39;t know the possible keys for the <strong>arguments</strong> column, so we will need to update it quite frequently.</li>
<li>We will eventually include other columns more than (type, emailAddress, from...)</li>
<li>We definitely don&#39;t want any performance donwside</li>
</ul>
<p>Our rescue to this situation is noSql databases, a document-oriented databse would be even better.<br>We will use MongoDB as data storage for those email related datasets.</p>
<p>Let&#39;s start by installing a MongoDB server and see it working. The installation procedure is very simple.</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;sudo&nbsp;apt-get&nbsp;install&nbsp;mongodb-server</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;mkdir&nbsp;~/mongo</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;mongod&nbsp;--dbpath&nbsp;~/mongo&nbsp;--rest</span></span></span></div></pre><blockquote>
<p>If you get an error <strong>locale::facet::_S_create_c_locale name not valid</strong> means that MongoDB is unable to work with your operating system&#39;s current locale. Adjusting your locale to C, should solve it: <code>$ export LC_ALL=C</code></p>
</blockquote>
<p>And start the server again. If everything is OK, you should be able to access the management interface at <a href="http://127.0.0.1:28017/">http://127.0.0.1:28017/</a></p>
<p>For more installation options, please visit <a href="http://docs.mongodb.org/manual/installation/">http://docs.mongodb.org/manual/installation/</a></p>
<p><br><br><br><br></p>
<p>We can go back to our application now, and implement persisting this data to MongoDB.</p>
<p>First, we need to load DoctrineMongoDBBundle.</p>
<ul>
<li>Edit  <strong>app/AppKernel.php</strong> and add<br><code>new Doctrine\Bundle\MongoDBBundle\DoctrineMongoDBBundle(),</code><br>to the list of loaded bundles.</li>
</ul>
<p><br></p>
<ul>
<li>Create <strong>app/config/doctrine_mongodb.yml</strong></li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>doctrine_mongodb:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>connections:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>default:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>server:&nbsp;mongodb://localhost:27017</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options:&nbsp;{}</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>document_managers:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>default:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>auto_mapping:&nbsp;true</span></span></span></div></pre><p><br></p>
<ul>
<li>Edit <strong>app/config/config.yml</strong> and add <code>- { resource: doctrine_mongodb.yml }</code> to the <em>imports</em> list</li>
</ul>
<p>Working with documents is not very different than working with entities, let&#39;s create the email document.</p>
<p><br></p>
<ul>
<li>Create <strong>src/AppBundle/Document/Email.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Document</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Doctrine</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ODM</span><span class="punctuation separator inheritance php"><span>\</span></span><span>MongoDB</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Mapping</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Annotations</span></span><span>&nbsp;</span><span class="keyword other use-as php"><span>as</span></span><span>&nbsp;</span><span class="support other namespace use-as php"><span>MongoDB</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;*&nbsp;@MongoDB\Document(db=&quot;app&quot;,&nbsp;collection=&quot;emails&quot;)</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>Email</span></span><span>&nbsp;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>REPOSITORY</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>AppBundle:Email</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>STATUS_SENT</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>1</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>STATUS_TEMPORARY_ERROR</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>2</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>STATUS_PERMANENT_ERROR</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>3</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@MongoDB\Id</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>id</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@MongoDB\String</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@MongoDB\String</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@MongoDB\String</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>from</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@MongoDB\String</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>subject</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@MongoDB\Bin</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>body</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@MongoDB\Int</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>status</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@MongoDB\Hash</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getId</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>id</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getType</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>type</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getEmailAddress</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>emailAddress</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getFrom</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>from</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getSubject</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>subject</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getBody</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>body</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getArguments</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>arguments</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setType</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>type</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setEmailAddress</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>emailAddress</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>emailAddress</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setFrom</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>from</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>from</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>from</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setSubject</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>subject</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>subject</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>subject</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setBody</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>body</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>body</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>body</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getStatus</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>status</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setStatus</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>status</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>status</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>status</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setArguments</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>arguments</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p>Done. Doctrine supports Mongo schema managements as well as it does with relational databases. Let&#39;s create our first database.</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;app/console&nbsp;doctrine:mongodb:schema:create</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Created&nbsp;dbs&nbsp;for&nbsp;all&nbsp;classes</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Created&nbsp;collections&nbsp;for&nbsp;all&nbsp;classes</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Created&nbsp;indexes&nbsp;for&nbsp;all&nbsp;classes</span></span></span></div></pre><p>Done, doctrine just created for us a database called <strong>app</strong> and an empty <strong>emails</strong> collection.</p>
<p>We will create a new listener that persist email documents to the database.</p>
<ul>
<li>Create <strong>src/AppBundle/Event/Listener/EmailCommunicationListener.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Event</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Listener</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Message</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Document</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Event</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span><span class="punctuation separator inheritance php"><span>\</span></span><span>EmailEvent</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Event</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span><span class="punctuation separator inheritance php"><span>\</span></span><span>EmailSendingEvent</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Doctrine</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Bundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>MongoDBBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ManagerRegistry</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Doctrine</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ODM</span><span class="punctuation separator inheritance php"><span>\</span></span><span>MongoDB</span><span class="punctuation separator inheritance php"><span>\</span></span><span>DocumentManager</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>EmailCommunicationListener</span></span><span>&nbsp;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;DocumentManager</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>documentManager</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="support function magic php"><span>__construct</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>ManagerRegistry</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>registry</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>documentManager</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>registry</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getManager</span></span><span>(</span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>onBeforeSend</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>EmailEvent</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>onEmailSent</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>EmailSendingEvent</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persistEmailMessage</span></span><span>(</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getMessage</span></span><span>(</span><span>),</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getType</span></span><span>(</span><span>),</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support class php"><span>Email</span></span><span class="keyword operator class php"><span>::</span></span><span class="constant other class php"><span>STATUS_SENT</span></span><span>,</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getArguments</span></span><span>(</span><span>)</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>onTemporaryError</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>EmailEvent</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persistEmailMessage</span></span><span>(</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getMessage</span></span><span>(</span><span>),</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getType</span></span><span>(</span><span>),</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support class php"><span>Email</span></span><span class="keyword operator class php"><span>::</span></span><span class="constant other class php"><span>STATUS_TEMPORARY_ERROR</span></span><span>,</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getArguments</span></span><span>(</span><span>)</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>onPermanentError</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>EmailEvent</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persistEmailMessage</span></span><span>(</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getMessage</span></span><span>(</span><span>),</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getType</span></span><span>(</span><span>),</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support class php"><span>Email</span></span><span class="keyword operator class php"><span>::</span></span><span class="constant other class php"><span>STATUS_PERMANENT_ERROR</span></span><span>,</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>event</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getArguments</span></span><span>(</span><span>)</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>persistEmailMessage</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>Message</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span></span><span>,</span><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span></span><span>,</span><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>status</span></span></span><span>,</span><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>email</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>Email</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>email</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setType</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>type</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>email</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setBody</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getMessage</span></span><span>(</span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>email</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setEmailAddress</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getTo</span></span><span>(</span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>email</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setFrom</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getFrom</span></span><span>(</span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>email</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setSubject</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getSubject</span></span><span>(</span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>email</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setArguments</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>email</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setStatus</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>status</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>documentManager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>persist</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>email</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>documentManager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>flush</span></span><span>(</span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br></p>
<ul>
<li>Edit <strong>src/AppBundle/Resources/config/events.xml</strong>, add the following parameters</li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&lt;parameter&nbsp;key=&quot;app.email.before_send&quot;&nbsp;type=&quot;constant&quot;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&gt;AppBundle\Event\Communication\Email\EmailEvent::BEFORE_SEND&lt;/parameter&gt;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&lt;parameter&nbsp;key=&quot;app.email.error_temporary&quot;&nbsp;type=&quot;constant&quot;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&gt;AppBundle\Event\Communication\Email\EmailEvent::ERROR_TEMPORARY&lt;/parameter&gt;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&lt;parameter&nbsp;key=&quot;app.email.error_permanent&quot;&nbsp;type=&quot;constant&quot;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&gt;AppBundle\Event\Communication\Email\EmailEvent::ERROR_PERMANENT&lt;/parameter&gt;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&lt;parameter&nbsp;key=&quot;app.email.sent&quot;&nbsp;type=&quot;constant&quot;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&gt;AppBundle\Event\Communication\Email\EmailEvent::SENT&lt;/parameter&gt;</span></span></span></div></pre><ul>
<li>Edit <strong>src/AppBundle/Resources/config/listeners.yml</strong>, add the following service definition</li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>app.email_communication_listener:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>class:&nbsp;AppBundle\Event\Listener\EmailCommunicationListener</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;arguments:&nbsp;[@doctrine_mongodb]</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;tags:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>-&nbsp;{name:&nbsp;kernel.event_listener,event:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>%app.email.before_send%,method:onBeforeSend}</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>-&nbsp;{name:&nbsp;kernel.event_listener,event:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>%app.email.error_temporary%,method:onTemporaryError}</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>-&nbsp;{name:&nbsp;kernel.event_listener,event:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>%app.email.error_permanent%,method:onPermanentError}</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>-&nbsp;{name:&nbsp;kernel.event_listener,event:&nbsp;%app.email.sent%,method:onEmailSent}</span></span></span></div></pre><ul>
<li>Edit <strong>src/AppBundle/Service/Communication/CommunicationService.php</strong><br>Add <code>use AppBundle\Document\Email;</code><br>Update <code>dispatchEmailSendingEvent</code> to dispatch the correct event name  </li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span>private&nbsp;function&nbsp;dispatchEmailSendingEvent($type,&nbsp;$arguments,&nbsp;$message,&nbsp;$status)</span></span></div><div class="line"><span class="text html php"><span>{</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;$event&nbsp;=&nbsp;new&nbsp;EmailSendingEvent($type,&nbsp;$arguments,&nbsp;$message);</span></span></div><div class="line"><span class="text html php"><span>&nbsp;</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;$eventNames&nbsp;=&nbsp;array(</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Email::STATUS_SENT&nbsp;=&gt;&nbsp;EmailSendingEvent::SENT,</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Email::STATUS_TEMPORARY_ERROR&nbsp;=&gt;&nbsp;EmailSendingEvent::ERROR_TEMPORARY,</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Email::STATUS_PERMANENT_ERROR&nbsp;=&gt;&nbsp;EmailSendingEvent::ERROR_PERMANENT</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;);</span></span></div><div class="line"><span class="text html php"><span>&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;eventDispatcher-&gt;dispatch($eventNames[$status],&nbsp;$event);</span></span></div><div class="line"><span class="text html php"><span>}</span></span></div></pre>
<p>To view the data and manage your MongoDB server, you need a mongo client.<br>There are plenty of GUIs applications to manage a MongoDB server. I personally prefer to use <a href="http://robomongo.org/">http://robomongo.org/</a>, is lightwight, cross-platform, and embeds the same JavaScript engine that is used by the the MongoDB mongo shell.<br>We can already experience the power of MongoDB search. You can try the following query:  </p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>db.getCollection(&#39;emails&#39;).find({&#39;arguments.customerName&#39;:&#39;contact&nbsp;1&#39;})</span></span></span></div></pre><p>This will fetch all the records that has the key <strong>arguments.customerName</strong> equals to <strong>contact 1</strong></p>
<p>What about <code>db.getCollection(&#39;emails&#39;).find({&#39;arguments.customerName&#39;:/contact*/})</code>? Isn&#39;t that awesome? To learn more about querying mongo data, I invite you to visit <a href="http://docs.mongodb.org/manual/reference/operator/query/where/">http://docs.mongodb.org/manual/reference/operator/query/where/</a></p>
<p><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<h2 id="9-4-external-provider">9.4 External provider</h2>
<p>We are going to use an external provider to send emails. For this example we will create a fake external provider that just returns on of possible status (success, temporary error, permanent error)</p>
<p><br></p>
<ul>
<li>Create <strong>src/AppBundle/Controller/ExternalProviderController.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Controller</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Bundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>FrameworkBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Controller</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Controller</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>HttpFoundation</span><span class="punctuation separator inheritance php"><span>\</span></span><span>JsonResponse</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>ExternalProviderController</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>Controller</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>indexAction</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function basic_functions php"><span>sleep</span></span><span>(</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="constant numeric php"><span>0</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>5</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>JsonResponse</span></span><span>(</span><span class="support function math php"><span>rand</span></span><span>(</span><span class="constant numeric php"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>3</span></span><span>))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p><br></p>
<ul>
<li>Edit <strong>src/AppBundle/Resources/config/routing.yml</strong> and add</li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>app_communication:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>resource:&nbsp;&quot;@AppBundle/Resources/config/routing/communication.yml&quot;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;prefix:&nbsp;&nbsp;&nbsp;/communication</span></span></span></div></pre><p><br></p>
<ul>
<li>Create <strong>src/AppBundle/Resources/config/routing/communication.yml</strong></li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>communication_external_provider:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>path:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/external_provider</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;defaults:&nbsp;{&nbsp;_controller:&nbsp;&quot;AppBundle:ExternalProvider:index&quot;&nbsp;}</span></span></span></div></pre><p><br><br><br><br><br><br></p>
<ul>
<li>Create <strong>src/AppBundle/Communication/Email/ExternalProvider.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Communication</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Email</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>ExternalProvider</span></span><span>&nbsp;</span><span class="storage modifier implements php"><span>implements</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>ProviderInterface</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>providerHost</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="support function magic php"><span>__construct</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>providerHost</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>providerHost</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>providerHost</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>send</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>Message</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>curl</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="support function curl php"><span>curl_init</span></span><span>()</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function curl php"><span>curl_setopt</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>curl</span></span><span>,&nbsp;</span><span class="support constant ext php"><span>CURLOPT_TIMEOUT</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>10</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function curl php"><span>curl_setopt</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>curl</span></span><span>,&nbsp;</span><span class="support constant ext php"><span>CURLOPT_RETURNTRANSFER</span></span><span>,&nbsp;</span><span class="constant language php"><span>true</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function curl php"><span>curl_setopt</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>curl</span></span><span>,&nbsp;</span><span class="support constant ext php"><span>CURLOPT_URL</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>providerHost</span></span><span>&nbsp;</span><span class="keyword operator string php"><span>.</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>/communication/external_provider</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>result</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="support function curl php"><span>curl_exec</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>curl</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function curl php"><span>curl_close</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>curl</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>result</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Edit <strong>src/AppBundle/Resources/config/services.yml</strong><br>Change <strong>app.email.calls.addProvider</strong> arguments to <strong>@app.provider_email_external</strong></li>
</ul>
<ul>
<li>Edit <strong>src/AppBundle/Resources/config/email_providers.yml</strong> and add</li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>app.provider_email_external:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>class:&nbsp;AppBundle\Communication\Email\ExternalProvider</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arguments:&nbsp;[%communication.external_provider_host%]</span></span></span></div></pre><ul>
<li>Edit <strong>app/config/parameters.yml.dist</strong> and add the parameter <code>communication.external_provider_host: #http://</code><br>Add the same parameter to <strong>app/config/parameters.yml</strong> the value should be your application&#39;s url but with a different host.</li>
</ul>
<p>On my dev environment I run two instances <a href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a> and <a href="http://127.0.0.1:8888/">http://127.0.0.1:8888/</a> so my parameter looks like <code>communication.external_provider_host: http://127.0.0.1:8888</code></p>
<p><br><br></p>
<h2 id="9-5-email-recycler-command">9.5 Email recycler command</h2>
<p>We will implement a command that will try to resend any emails that have a temporary error.</p>
<ul>
<li><p>Edit <strong>src/AppBundle/Event/Communication/Email/EmailEvent.php</strong> and add the constant <code>const RESEND = &#39;email.resend&#39;;</code></p>
</li>
<li><p>Create <strong>src/AppBundle/Command/EmailsRecyclerCommand.php</strong></p>
</li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&lt;?php</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>namespace&nbsp;AppBundle\Command;</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;AppBundle\Communication\Email\Message;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;AppBundle\Document\Email;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;AppBundle\Event\Communication\Email\EmailEvent;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;AppBundle\Service\Communication\CommunicationService;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;Doctrine\ODM\MongoDB\DocumentManager;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;Symfony\Bundle\FrameworkBundle\Command\ContainerAwareCommand;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;Symfony\Component\Console\Input\InputInterface;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;Symfony\Component\Console\Input\InputOption;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;Symfony\Component\Console\Output\OutputInterface;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>use&nbsp;Symfony\Component\EventDispatcher\EventDispatcher;</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>class&nbsp;EmailsRecyclerCommand&nbsp;extends&nbsp;ContainerAwareCommand</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>{</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>/**</span></span></span></div><div class="line"><span class="text plain"><span class="meta bullet-point star text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition item text"><span>*</span></span><span>&nbsp;</span></span></span></div><div class="line"><span class="text plain"><span class="meta bullet-point star text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition item text"><span>*</span></span><span>&nbsp;@var&nbsp;CommunicationService</span></span></span></div><div class="line"><span class="text plain"><span class="meta bullet-point star text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition item text"><span>*</span></span><span>/</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>private&nbsp;$communicationService;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;/**</span></span></span></div><div class="line"><span class="text plain"><span class="meta bullet-point star text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition item text"><span>*</span></span><span>&nbsp;</span></span></span></div><div class="line"><span class="text plain"><span class="meta bullet-point star text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition item text"><span>*</span></span><span>&nbsp;@var&nbsp;DocumentManager</span></span></span></div><div class="line"><span class="text plain"><span class="meta bullet-point star text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition item text"><span>*</span></span><span>/</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>private&nbsp;$documentManager;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;/**</span></span></span></div><div class="line"><span class="text plain"><span class="meta bullet-point star text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition item text"><span>*</span></span><span>&nbsp;</span></span></span></div><div class="line"><span class="text plain"><span class="meta bullet-point star text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition item text"><span>*</span></span><span>&nbsp;@var&nbsp;EventDispatcher</span></span></span></div><div class="line"><span class="text plain"><span class="meta bullet-point star text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition item text"><span>*</span></span><span>/</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>private&nbsp;$eventDispatcher;</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>protected&nbsp;function&nbsp;configure()</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>parent::configure();</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;setName(&#39;app:communication:recycler:emails&#39;);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;setDescription(&#39;Retries&nbsp;the&nbsp;sending&nbsp;of&nbsp;emails&nbsp;with&nbsp;temporary&nbsp;error&#39;);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;addOption(</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>&#39;limit&#39;,&nbsp;&#39;-l&#39;,</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputOption::VALUE_OPTIONAL,</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>&#39;Number&nbsp;of&nbsp;emails&nbsp;to&nbsp;resend&#39;,</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>);</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>}</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>protected&nbsp;function&nbsp;initialize(InputInterface&nbsp;$input,&nbsp;OutputInterface&nbsp;$output)</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>parent::initialize($input,&nbsp;$output);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;communicationService&nbsp;=&nbsp;$this-&gt;getContainer()</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>-&gt;get(CommunicationService::ID);</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>$this-&gt;documentManager&nbsp;=&nbsp;$this-&gt;getContainer()</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>-&gt;get(&#39;doctrine_mongodb&#39;)</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;getManager();</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>$this-&gt;eventDispatcher&nbsp;=&nbsp;$this-&gt;getContainer()-&gt;get(&#39;event_dispatcher&#39;);</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>}</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>protected&nbsp;function&nbsp;execute(InputInterface&nbsp;$input,&nbsp;OutputInterface&nbsp;$output)</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>$limit&nbsp;=&nbsp;$input-&gt;getOption(&#39;limit&#39;);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$emailsRepository&nbsp;=&nbsp;$this-&gt;documentManager-&gt;getRepository(Email::REPOSITORY);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$emails&nbsp;=&nbsp;$emailsRepository-&gt;findBy(</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>array(&#39;status&#39;&nbsp;=&gt;&nbsp;Email::STATUS_TEMPORARY_ERROR),&nbsp;null,&nbsp;$limit</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>);</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>foreach&nbsp;($emails&nbsp;as&nbsp;$email)&nbsp;{</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>/*&nbsp;@var&nbsp;$email&nbsp;Email&nbsp;*/</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$type&nbsp;=&nbsp;$email-&gt;getType();</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$emailAddress&nbsp;=&nbsp;$email-&gt;getEmailAddress();</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arguments&nbsp;=&nbsp;$email-&gt;getArguments();</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;eventDispatcher-&gt;dispatch(</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>EmailEvent::RESEND,&nbsp;new&nbsp;EmailEvent($type,&nbsp;$emailAddress,&nbsp;$arguments)</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>);</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>$status&nbsp;=&nbsp;$this-&gt;communicationService</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>-&gt;sendEmail($type,&nbsp;$emailAddress,&nbsp;$arguments);</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>$email-&gt;setStatus($status);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;documentManager-&gt;persist($email);</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>}</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;documentManager-&gt;flush();</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>}</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>}</span></span></span></div></pre><p>Done, to run the command: <code>app/console  app:communication:recycler:emails</code></p>
<h2 id="9-5-homework">9.5 Homework</h2>
<ol>
<li>When calling the external provider, handle any network or HTTP problems as temporary errors.</li>
<li>Update the <strong>Email</strong> document to add <strong>create_date</strong> and <strong>update_date</strong> and <strong>retry_count</strong></li>
</ol></body>
</html>
