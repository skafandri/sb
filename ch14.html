<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <title>ch14</title>
      <style>.markdown-preview, .markdown-preview[data-use-github-style] { font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; font-size: 16px; line-height: 1.6; word-wrap: break-word; overflow: scroll; box-sizing: border-box; padding: 20px; background-color: rgb(255, 255, 255); }
.markdown-preview > :first-child, .markdown-preview[data-use-github-style] > :first-child { margin-top: 0px !important; }
.markdown-preview > :last-child, .markdown-preview[data-use-github-style] > :last-child { margin-bottom: 0px !important; }
.markdown-preview a:not([href]), .markdown-preview[data-use-github-style] a:not([href]) { color: inherit; text-decoration: none; }
.markdown-preview .absent, .markdown-preview[data-use-github-style] .absent { color: rgb(204, 0, 0); }
.markdown-preview .anchor, .markdown-preview[data-use-github-style] .anchor { position: absolute; top: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; }
.markdown-preview .anchor:focus, .markdown-preview[data-use-github-style] .anchor:focus { outline: none; }
.markdown-preview h1, .markdown-preview[data-use-github-style] h1, .markdown-preview h2, .markdown-preview[data-use-github-style] h2, .markdown-preview h3, .markdown-preview[data-use-github-style] h3, .markdown-preview h4, .markdown-preview[data-use-github-style] h4, .markdown-preview h5, .markdown-preview[data-use-github-style] h5, .markdown-preview h6, .markdown-preview[data-use-github-style] h6 { position: relative; margin-top: 1em; margin-bottom: 16px; font-weight: bold; line-height: 1.4; }
.markdown-preview h1 .octicon-link, .markdown-preview[data-use-github-style] h1 .octicon-link, .markdown-preview h2 .octicon-link, .markdown-preview[data-use-github-style] h2 .octicon-link, .markdown-preview h3 .octicon-link, .markdown-preview[data-use-github-style] h3 .octicon-link, .markdown-preview h4 .octicon-link, .markdown-preview[data-use-github-style] h4 .octicon-link, .markdown-preview h5 .octicon-link, .markdown-preview[data-use-github-style] h5 .octicon-link, .markdown-preview h6 .octicon-link, .markdown-preview[data-use-github-style] h6 .octicon-link { display: none; color: rgb(0, 0, 0); vertical-align: middle; }
.markdown-preview h1:hover .anchor, .markdown-preview[data-use-github-style] h1:hover .anchor, .markdown-preview h2:hover .anchor, .markdown-preview[data-use-github-style] h2:hover .anchor, .markdown-preview h3:hover .anchor, .markdown-preview[data-use-github-style] h3:hover .anchor, .markdown-preview h4:hover .anchor, .markdown-preview[data-use-github-style] h4:hover .anchor, .markdown-preview h5:hover .anchor, .markdown-preview[data-use-github-style] h5:hover .anchor, .markdown-preview h6:hover .anchor, .markdown-preview[data-use-github-style] h6:hover .anchor { padding-left: 8px; margin-left: -30px; text-decoration: none; }
.markdown-preview h1:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h1:hover .anchor .octicon-link, .markdown-preview h2:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h2:hover .anchor .octicon-link, .markdown-preview h3:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h3:hover .anchor .octicon-link, .markdown-preview h4:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h4:hover .anchor .octicon-link, .markdown-preview h5:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h5:hover .anchor .octicon-link, .markdown-preview h6:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h6:hover .anchor .octicon-link { display: inline-block; }
.markdown-preview h1 tt, .markdown-preview[data-use-github-style] h1 tt, .markdown-preview h2 tt, .markdown-preview[data-use-github-style] h2 tt, .markdown-preview h3 tt, .markdown-preview[data-use-github-style] h3 tt, .markdown-preview h4 tt, .markdown-preview[data-use-github-style] h4 tt, .markdown-preview h5 tt, .markdown-preview[data-use-github-style] h5 tt, .markdown-preview h6 tt, .markdown-preview[data-use-github-style] h6 tt, .markdown-preview h1 code, .markdown-preview[data-use-github-style] h1 code, .markdown-preview h2 code, .markdown-preview[data-use-github-style] h2 code, .markdown-preview h3 code, .markdown-preview[data-use-github-style] h3 code, .markdown-preview h4 code, .markdown-preview[data-use-github-style] h4 code, .markdown-preview h5 code, .markdown-preview[data-use-github-style] h5 code, .markdown-preview h6 code, .markdown-preview[data-use-github-style] h6 code { font-size: inherit; }
.markdown-preview h1, .markdown-preview[data-use-github-style] h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview h1 .anchor, .markdown-preview[data-use-github-style] h1 .anchor { line-height: 1; }
.markdown-preview h2, .markdown-preview[data-use-github-style] h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview h2 .anchor, .markdown-preview[data-use-github-style] h2 .anchor { line-height: 1; }
.markdown-preview h3, .markdown-preview[data-use-github-style] h3 { font-size: 1.5em; line-height: 1.43; }
.markdown-preview h3 .anchor, .markdown-preview[data-use-github-style] h3 .anchor { line-height: 1.2; }
.markdown-preview h4, .markdown-preview[data-use-github-style] h4 { font-size: 1.25em; }
.markdown-preview h4 .anchor, .markdown-preview[data-use-github-style] h4 .anchor { line-height: 1.2; }
.markdown-preview h5, .markdown-preview[data-use-github-style] h5 { font-size: 1em; }
.markdown-preview h5 .anchor, .markdown-preview[data-use-github-style] h5 .anchor { line-height: 1.1; }
.markdown-preview h6, .markdown-preview[data-use-github-style] h6 { font-size: 1em; color: rgb(119, 119, 119); }
.markdown-preview h6 .anchor, .markdown-preview[data-use-github-style] h6 .anchor { line-height: 1.1; }
.markdown-preview p, .markdown-preview[data-use-github-style] p, .markdown-preview blockquote, .markdown-preview[data-use-github-style] blockquote, .markdown-preview ul, .markdown-preview[data-use-github-style] ul, .markdown-preview ol, .markdown-preview[data-use-github-style] ol, .markdown-preview dl, .markdown-preview[data-use-github-style] dl, .markdown-preview table, .markdown-preview[data-use-github-style] table, .markdown-preview pre, .markdown-preview[data-use-github-style] pre { margin-top: 0px; margin-bottom: 16px; }
.markdown-preview hr, .markdown-preview[data-use-github-style] hr { height: 4px; padding: 0px; margin: 16px 0px; border: 0px none; background-color: rgb(231, 231, 231); }
.markdown-preview ul, .markdown-preview[data-use-github-style] ul, .markdown-preview ol, .markdown-preview[data-use-github-style] ol { padding-left: 2em; }
.markdown-preview ul.no-list, .markdown-preview[data-use-github-style] ul.no-list, .markdown-preview ol.no-list, .markdown-preview[data-use-github-style] ol.no-list { padding: 0px; list-style-type: none; }
.markdown-preview ul ul, .markdown-preview[data-use-github-style] ul ul, .markdown-preview ul ol, .markdown-preview[data-use-github-style] ul ol, .markdown-preview ol ol, .markdown-preview[data-use-github-style] ol ol, .markdown-preview ol ul, .markdown-preview[data-use-github-style] ol ul { margin-top: 0px; margin-bottom: 0px; }
.markdown-preview li > p, .markdown-preview[data-use-github-style] li > p { margin-top: 16px; }
.markdown-preview dl, .markdown-preview[data-use-github-style] dl { padding: 0px; }
.markdown-preview dl dt, .markdown-preview[data-use-github-style] dl dt { padding: 0px; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: bold; }
.markdown-preview dl dd, .markdown-preview[data-use-github-style] dl dd { padding: 0px 16px; margin-bottom: 16px; }
.markdown-preview blockquote, .markdown-preview[data-use-github-style] blockquote { padding: 0px 15px; color: rgb(119, 119, 119); border-left-width: 4px; border-left-style: solid; border-left-color: rgb(221, 221, 221); }
.markdown-preview blockquote > :first-child, .markdown-preview[data-use-github-style] blockquote > :first-child { margin-top: 0px; }
.markdown-preview blockquote > :last-child, .markdown-preview[data-use-github-style] blockquote > :last-child { margin-bottom: 0px; }
.markdown-preview table, .markdown-preview[data-use-github-style] table { display: block; width: 100%; overflow: auto; word-break: normal; }
.markdown-preview table th, .markdown-preview[data-use-github-style] table th { font-weight: bold; }
.markdown-preview table th, .markdown-preview[data-use-github-style] table th, .markdown-preview table td, .markdown-preview[data-use-github-style] table td { padding: 6px 13px; border: 1px solid rgb(221, 221, 221); }
.markdown-preview table tr, .markdown-preview[data-use-github-style] table tr { border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(255, 255, 255); }
.markdown-preview table tr:nth-child(2n), .markdown-preview[data-use-github-style] table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
.markdown-preview img, .markdown-preview[data-use-github-style] img { max-width: 100%; box-sizing: border-box; }
.markdown-preview .emoji, .markdown-preview[data-use-github-style] .emoji { max-width: none; }
.markdown-preview span.frame, .markdown-preview[data-use-github-style] span.frame { display: block; overflow: hidden; }
.markdown-preview span.frame > span, .markdown-preview[data-use-github-style] span.frame > span { display: block; float: left; width: auto; padding: 7px; margin: 13px 0px 0px; overflow: hidden; border: 1px solid rgb(221, 221, 221); }
.markdown-preview span.frame span img, .markdown-preview[data-use-github-style] span.frame span img { display: block; float: left; }
.markdown-preview span.frame span span, .markdown-preview[data-use-github-style] span.frame span span { display: block; padding: 5px 0px 0px; clear: both; color: rgb(51, 51, 51); }
.markdown-preview span.align-center, .markdown-preview[data-use-github-style] span.align-center { display: block; overflow: hidden; clear: both; }
.markdown-preview span.align-center > span, .markdown-preview[data-use-github-style] span.align-center > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: center; }
.markdown-preview span.align-center span img, .markdown-preview[data-use-github-style] span.align-center span img { margin: 0px auto; text-align: center; }
.markdown-preview span.align-right, .markdown-preview[data-use-github-style] span.align-right { display: block; overflow: hidden; clear: both; }
.markdown-preview span.align-right > span, .markdown-preview[data-use-github-style] span.align-right > span { display: block; margin: 13px 0px 0px; overflow: hidden; text-align: right; }
.markdown-preview span.align-right span img, .markdown-preview[data-use-github-style] span.align-right span img { margin: 0px; text-align: right; }
.markdown-preview span.float-left, .markdown-preview[data-use-github-style] span.float-left { display: block; float: left; margin-right: 13px; overflow: hidden; }
.markdown-preview span.float-left span, .markdown-preview[data-use-github-style] span.float-left span { margin: 13px 0px 0px; }
.markdown-preview span.float-right, .markdown-preview[data-use-github-style] span.float-right { display: block; float: right; margin-left: 13px; overflow: hidden; }
.markdown-preview span.float-right > span, .markdown-preview[data-use-github-style] span.float-right > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: right; }
.markdown-preview code, .markdown-preview[data-use-github-style] code, .markdown-preview tt, .markdown-preview[data-use-github-style] tt { padding: 0.2em 0px; margin: 0px; font-size: 85%; border-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157); }
.markdown-preview code::before, .markdown-preview[data-use-github-style] code::before, .markdown-preview tt::before, .markdown-preview[data-use-github-style] tt::before, .markdown-preview code::after, .markdown-preview[data-use-github-style] code::after, .markdown-preview tt::after, .markdown-preview[data-use-github-style] tt::after { letter-spacing: -0.2em; content: 'Â '; }
.markdown-preview code br, .markdown-preview[data-use-github-style] code br, .markdown-preview tt br, .markdown-preview[data-use-github-style] tt br { display: none; }
.markdown-preview del code, .markdown-preview[data-use-github-style] del code { text-decoration: inherit; }
.markdown-preview pre > code, .markdown-preview[data-use-github-style] pre > code { padding: 0px; margin: 0px; font-size: 100%; word-break: normal; white-space: pre; border: 0px; background: transparent; }
.markdown-preview .highlight, .markdown-preview[data-use-github-style] .highlight { margin-bottom: 16px; }
.markdown-preview .highlight pre, .markdown-preview[data-use-github-style] .highlight pre, .markdown-preview pre, .markdown-preview[data-use-github-style] pre { padding: 16px; overflow: auto; font-size: 85%; line-height: 1.45; border-radius: 3px; background-color: rgb(247, 247, 247); }
.markdown-preview .highlight pre, .markdown-preview[data-use-github-style] .highlight pre { margin-bottom: 0px; word-break: normal; }
.markdown-preview pre, .markdown-preview[data-use-github-style] pre { word-wrap: normal; }
.markdown-preview pre code, .markdown-preview[data-use-github-style] pre code, .markdown-preview pre tt, .markdown-preview[data-use-github-style] pre tt { display: inline; max-width: initial; padding: 0px; margin: 0px; overflow: initial; line-height: inherit; word-wrap: normal; border: 0px; background-color: transparent; }
.markdown-preview pre code::before, .markdown-preview[data-use-github-style] pre code::before, .markdown-preview pre tt::before, .markdown-preview[data-use-github-style] pre tt::before, .markdown-preview pre code::after, .markdown-preview[data-use-github-style] pre code::after, .markdown-preview pre tt::after, .markdown-preview[data-use-github-style] pre tt::after { content: normal; }
.markdown-preview kbd, .markdown-preview[data-use-github-style] kbd { display: inline-block; padding: 3px 5px; font-size: 11px; line-height: 10px; color: rgb(85, 85, 85); vertical-align: middle; border-style: solid; border-width: 1px; border-color: rgb(204, 204, 204) rgb(204, 204, 204) rgb(187, 187, 187); border-radius: 3px; box-shadow: rgb(187, 187, 187) 0px -1px 0px inset; background-color: rgb(252, 252, 252); }
.markdown-preview, .markdown-preview[data-use-github-style], .markdown-preview code, .markdown-preview[data-use-github-style] code { color: rgb(51, 51, 51); }
.markdown-preview h1, .markdown-preview[data-use-github-style] h1, .markdown-preview h2, .markdown-preview[data-use-github-style] h2, .markdown-preview h3, .markdown-preview[data-use-github-style] h3, .markdown-preview h4, .markdown-preview[data-use-github-style] h4, .markdown-preview h5, .markdown-preview[data-use-github-style] h5, .markdown-preview h6, .markdown-preview[data-use-github-style] h6 { -webkit-font-smoothing: antialiased; cursor: text; }
.markdown-preview > h1:first-child, .markdown-preview[data-use-github-style] > h1:first-child, .markdown-preview > h1:first-child + h2, .markdown-preview[data-use-github-style] > h1:first-child + h2, .markdown-preview > h2:first-child, .markdown-preview[data-use-github-style] > h2:first-child, .markdown-preview > h3:first-child, .markdown-preview[data-use-github-style] > h3:first-child, .markdown-preview > h4:first-child, .markdown-preview[data-use-github-style] > h4:first-child, .markdown-preview > h5:first-child, .markdown-preview[data-use-github-style] > h5:first-child, .markdown-preview > h6:first-child, .markdown-preview[data-use-github-style] > h6:first-child { margin-top: 0px; padding-top: 0px; }
.markdown-preview a, .markdown-preview[data-use-github-style] a, .markdown-preview a code, .markdown-preview[data-use-github-style] a code { color: rgb(65, 131, 196); }
.markdown-preview a:first-child h1, .markdown-preview[data-use-github-style] a:first-child h1, .markdown-preview a:first-child h2, .markdown-preview[data-use-github-style] a:first-child h2, .markdown-preview a:first-child h3, .markdown-preview[data-use-github-style] a:first-child h3, .markdown-preview a:first-child h4, .markdown-preview[data-use-github-style] a:first-child h4, .markdown-preview a:first-child h5, .markdown-preview[data-use-github-style] a:first-child h5, .markdown-preview a:first-child h6, .markdown-preview[data-use-github-style] a:first-child h6 { margin-top: 0px; padding-top: 0px; }
.markdown-preview h1 + p, .markdown-preview[data-use-github-style] h1 + p, .markdown-preview h2 + p, .markdown-preview[data-use-github-style] h2 + p, .markdown-preview h3 + p, .markdown-preview[data-use-github-style] h3 + p, .markdown-preview h4 + p, .markdown-preview[data-use-github-style] h4 + p, .markdown-preview h5 + p, .markdown-preview[data-use-github-style] h5 + p, .markdown-preview h6 + p, .markdown-preview[data-use-github-style] h6 + p { margin-top: 0px; }
.markdown-preview li p.first, .markdown-preview[data-use-github-style] li p.first { display: inline-block; }
.markdown-preview ul li > :first-child, .markdown-preview[data-use-github-style] ul li > :first-child, .markdown-preview ol li > :first-child, .markdown-preview[data-use-github-style] ol li > :first-child, .markdown-preview ul li ul:first-of-type, .markdown-preview[data-use-github-style] ul li ul:first-of-type, .markdown-preview ol li ul:first-of-type, .markdown-preview[data-use-github-style] ol li ul:first-of-type { margin-top: 0px; }
.markdown-preview ol > li, .markdown-preview[data-use-github-style] ol > li { list-style-type: decimal; }
.markdown-preview ul > li, .markdown-preview[data-use-github-style] ul > li { list-style-type: disc; }
.markdown-preview dl dt:first-child, .markdown-preview[data-use-github-style] dl dt:first-child { padding: 0px; }
.markdown-preview dl dt > :first-child, .markdown-preview[data-use-github-style] dl dt > :first-child { margin-top: 0px; }
.markdown-preview dl dt > :last-child, .markdown-preview[data-use-github-style] dl dt > :last-child { margin-bottom: 0px; }
.markdown-preview dl dd > :first-child, .markdown-preview[data-use-github-style] dl dd > :first-child { margin-top: 0px; }
.markdown-preview dl dd > :last-child, .markdown-preview[data-use-github-style] dl dd > :last-child { margin-bottom: 0px; }
.markdown-preview blockquote p, .markdown-preview[data-use-github-style] blockquote p { font-size: 16px; line-height: 1.5; }
.markdown-preview pre.editor-colors, .markdown-preview[data-use-github-style] pre.editor-colors { padding: 16px; overflow: auto; font-size: 84%; line-height: 1.45; border-radius: 3px; background-color: rgb(40, 44, 52); }
.markdown-preview pre.editor-colors, .markdown-preview[data-use-github-style] pre.editor-colors { margin-bottom: 16px; word-break: normal; }
.markdown-preview code, .markdown-preview[data-use-github-style] code, .markdown-preview tt, .markdown-preview[data-use-github-style] tt, .markdown-preview pre.editor-colors, .markdown-preview[data-use-github-style] pre.editor-colors { font-family: Consolas, 'Liberation Mono', Courier, monospace; }
.markdown-preview .emoji, .markdown-preview[data-use-github-style] .emoji { height: 20px; width: 20px; }
.markdown-preview { font-size: 1.25em; color: rgb(44, 49, 58); background-color: rgb(241, 242, 244); }
.markdown-preview h1, .markdown-preview h2 { color: inherit; border-color: rgb(186, 191, 202); }
.markdown-preview a { color: rgb(20, 146, 255); }
.markdown-preview hr { background-color: rgb(241, 242, 244); }
.markdown-preview blockquote { color: rgb(44, 49, 58); border-left-color: rgb(117, 127, 149); }
.markdown-preview table th, .markdown-preview table td { border-color: rgb(186, 191, 202); }
.markdown-preview table th { background-color: rgb(249, 250, 251); }
.markdown-preview table tr { background-color: rgb(241, 242, 244); }
.markdown-preview table tr:nth-child(2n) { background-color: rgb(232, 234, 237); }
.markdown-preview code { color: rgb(67, 73, 86); border-color: rgb(186, 191, 202); background-color: rgb(229, 231, 235); background-clip: padding-box; }
.markdown-preview pre.editor-colors::shadow .line.cursor-line { background-color: transparent; }
.bracket-matcher .region {
  border-bottom: 1px dotted lime;
  position: absolute;
}

.spell-check-misspelling .region {
  border-bottom: 1px dashed rgba(250, 128, 114, 0.5);
}

pre.editor-colors,
.host {
  background-color: #282c34;
  color: #abb2bf;
}
pre.editor-colors .line.cursor-line,
.host .line.cursor-line {
  background-color: rgba(153, 187, 255, 0.04);
}
pre.editor-colors .invisible,
.host .invisible {
  color: #abb2bf;
}
pre.editor-colors .cursor,
.host .cursor {
  border-left: 2px solid #528bff;
}
pre.editor-colors .selection .region,
.host .selection .region {
  background-color: #3e4451;
}
pre.editor-colors .bracket-matcher .region,
.host .bracket-matcher .region {
  border-bottom: 1px solid #528bff;
  box-sizing: border-box;
  background-color: #353b45;
}
pre.editor-colors .invisible-character,
.host .invisible-character {
  color: rgba(171, 178, 191, 0.15);
}
pre.editor-colors .indent-guide,
.host .indent-guide {
  color: rgba(171, 178, 191, 0.15);
}
pre.editor-colors .wrap-guide,
.host .wrap-guide {
  background-color: rgba(171, 178, 191, 0.15);
}
pre.editor-colors .gutter .line-number,
.host .gutter .line-number {
  color: #636d83;
  -webkit-font-smoothing: antialiased;
}
pre.editor-colors .gutter .line-number.git-line-removed:before,
.host .gutter .line-number.git-line-removed:before {
  bottom: -3px;
}
pre.editor-colors .gutter .line-number.git-line-removed:after,
.host .gutter .line-number.git-line-removed:after {
  content: "";
  position: absolute;
  left: 0px;
  bottom: 0px;
  width: 25px;
  border-bottom: 1px dotted rgba(224, 82, 82, 0.5);
  pointer-events: none;
}
pre.editor-colors .gutter .line-number.cursor-line,
.host .gutter .line-number.cursor-line {
  color: #abb2bf;
  background-color: #2c313a;
}
pre.editor-colors .gutter .line-number.cursor-line-no-selection,
.host .gutter .line-number.cursor-line-no-selection {
  background-color: transparent;
}
pre.editor-colors .gutter .line-number .icon-right,
.host .gutter .line-number .icon-right {
  color: #abb2bf;
}
pre.editor-colors .gutter .line-number .icon-right,
.host .gutter .line-number .icon-right {
  color: #abb2bf;
}
pre.editor-colors .gutter .line-number.folded,
.host .gutter .line-number.folded,
pre.editor-colors .gutter .line-number:after,
.host .gutter .line-number:after,
pre.editor-colors .fold-marker:after,
.host .fold-marker:after {
  color: #abb2bf;
}
.comment {
  color: #5c6370;
  font-style: italic;
}
.entity.name.type {
  color: #e5c07b;
}
.entity.other.inherited-class {
  color: #98c379;
}
.keyword {
  color: #c678dd;
}
.keyword.control {
  color: #c678dd;
}
.keyword.operator {
  color: #abb2bf;
}
.keyword.other.special-method {
  color: #61afef;
}
.keyword.other.unit {
  color: #d19a66;
}
.storage {
  color: #c678dd;
}
.storage.type.annotation,
.storage.type.primitive {
  color: #c678dd;
}
.storage.modifier.package,
.storage.modifier.import {
  color: #abb2bf;
}
.constant {
  color: #d19a66;
}
.constant.variable {
  color: #d19a66;
}
.constant.character.escape {
  color: #56b6c2;
}
.constant.numeric {
  color: #d19a66;
}
.constant.other.color {
  color: #56b6c2;
}
.constant.other.symbol {
  color: #56b6c2;
}
.variable {
  color: #e06c75;
}
.variable.interpolation {
  color: #be5046;
}
.variable.parameter {
  color: #abb2bf;
}
.invalid.illegal {
  background-color: #e06c75;
  color: #282c34;
}
.string {
  color: #98c379;
}
.string.regexp {
  color: #56b6c2;
}
.string.regexp .source.ruby.embedded {
  color: #e5c07b;
}
.string.other.link {
  color: #e06c75;
}
.punctuation.definition.comment {
  color: #5c6370;
}
.punctuation.definition.method-parameters,
.punctuation.definition.function-parameters,
.punctuation.definition.parameters,
.punctuation.definition.separator,
.punctuation.definition.seperator,
.punctuation.definition.array {
  color: #abb2bf;
}
.punctuation.definition.heading,
.punctuation.definition.identity {
  color: #61afef;
}
.punctuation.definition.bold {
  color: #e5c07b;
  font-weight: bold;
}
.punctuation.definition.italic {
  color: #c678dd;
  font-style: italic;
}
.punctuation.section.embedded {
  color: #be5046;
}
.punctuation.section.method,
.punctuation.section.class,
.punctuation.section.inner-class {
  color: #abb2bf;
}
.support.class {
  color: #e5c07b;
}
.support.function {
  color: #56b6c2;
}
.support.function.any-method {
  color: #61afef;
}
.entity.name.function {
  color: #61afef;
}
.entity.name.class,
.entity.name.type.class {
  color: #e5c07b;
}
.entity.name.section {
  color: #61afef;
}
.entity.name.tag {
  color: #e06c75;
}
.entity.other.attribute-name {
  color: #d19a66;
}
.entity.other.attribute-name.id {
  color: #61afef;
}
.meta.class {
  color: #e5c07b;
}
.meta.class.body {
  color: #abb2bf;
}
.meta.method-call,
.meta.method {
  color: #abb2bf;
}
.meta.definition.variable {
  color: #e06c75;
}
.meta.link {
  color: #d19a66;
}
.meta.require {
  color: #61afef;
}
.meta.selector {
  color: #c678dd;
}
.meta.separator {
  background-color: #373b41;
  color: #abb2bf;
}
.meta.tag {
  color: #abb2bf;
}
.none {
  color: #abb2bf;
}
.markup.bold {
  color: #d19a66;
  font-weight: bold;
}
.markup.changed {
  color: #c678dd;
}
.markup.deleted {
  color: #e06c75;
}
.markup.italic {
  color: #c678dd;
  font-style: italic;
}
.markup.heading .punctuation.definition.heading {
  color: #61afef;
}
.markup.inserted {
  color: #98c379;
}
.markup.list {
  color: #e06c75;
}
.markup.quote {
  color: #d19a66;
}
.markup.raw.inline {
  color: #98c379;
}
.source.cs .keyword.operator {
  color: #c678dd;
}
.source.css .property-name,
.source.css .property-value {
  color: #828997;
}
.source.css .property-name.support,
.source.css .property-value.support {
  color: #abb2bf;
}
.source.gfm .markup {
  -webkit-font-smoothing: auto;
}
.source.gfm .markup.heading {
  color: #e06c75;
}
.source.gfm .markup.link {
  color: #c678dd;
}
.source.gfm .link .entity {
  color: #61afef;
}
.source.ini .keyword.other.definition.ini {
  color: #e06c75;
}
.source.java .storage.modifier.import {
  color: #e5c07b;
}
.source.java .storage.type {
  color: #e5c07b;
}
.source.java-properties .meta.key-pair {
  color: #e06c75;
}
.source.java-properties .meta.key-pair > .punctuation {
  color: #abb2bf;
}
.source.json .meta.structure.dictionary.json > .string.quoted.json {
  color: #e06c75;
}
.source.json .meta.structure.dictionary.json > .string.quoted.json > .punctuation.string {
  color: #e06c75;
}
.source.json .meta.structure.dictionary.json > .value.json > .string.quoted.json,
.source.json .meta.structure.array.json > .value.json > .string.quoted.json,
.source.json .meta.structure.dictionary.json > .value.json > .string.quoted.json > .punctuation,
.source.json .meta.structure.array.json > .value.json > .string.quoted.json > .punctuation {
  color: #98c379;
}
.source.json .meta.structure.dictionary.json > .constant.language.json,
.source.json .meta.structure.array.json > .constant.language.json {
  color: #56b6c2;
}
.source.ruby .constant.other.symbol > .punctuation {
  color: inherit;
}
.source.python .keyword.operator.logical.python {
  color: #c678dd;
}
.source.python .variable.parameter {
  color: #d19a66;
}
</style>
  </head>
  <body class='markdown-preview'><h1 id="14-tips-tricks">14 Tips &amp; tricks</h1>
<p>We are going to be working on the repository that you have created up to this point. If you skipped
ahead, don&#39;t worry. You can clone the repository from its Github repository.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>git&nbsp;clone&nbsp;git@github.com:symfony-tutorial/app.git</span></span></div><div class="line"><span class="source shell"><span>git&nbsp;clone&nbsp;git@github.com:symfony-tutorial/store.git</span></span></div></pre>
<p>Don&#39;t forget to <code>composer install</code></p>
<p>Every section&#39;s code is in a separate branch with the section&#39;s number. So to get the code for the first section of this chapter, just <code>git checkout 14.1</code></p>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<h2 id="14-1-override-a-custom-twig-filter">14.1 Override a custom Twig filter</h2>
<p>When we designed our database, we agreed to save money values as integers representing cents of the currency. This implies that we should divide the stored amount by 100 when showing it to human users.</p>
<p>Let&#39;s take a look again at <strong>src/AppBundle/Resources/views/Document/Common/product-line.html.twig</strong></p>
<pre class="editor-colors lang-html"><div class="line"><span class="text html basic"><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag inline any html"><span>tr</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span><span>{{productLine.code}}</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span><span>{{productLine.title}}</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span><span>{{productLine.price|localizedcurrency(currency)}}</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span><span>{{productLine.quantity}}</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span><span>{{productLine.total|localizedcurrency(currency)}}</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag inline any html"><span>td</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag inline any html"><span>tr</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div></pre>
<p>We will override the <strong>localizedcurrency</strong> Twig filter to always divide the value parameter by 10.</p>
<ul>
<li>Create <strong>src/AppBundle/Twig/Extension/Intl.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Twig</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Extension</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>Intl</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="support other namespace php"><span class="punctuation separator inheritance php"><span>\</span></span></span><span class="entity other inherited-class php"><span>Twig_Extensions_Extension_Intl</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getFilters</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="support function array php"><span>array_merge</span></span><span>(</span><span class="storage type php"><span>parent</span></span><span class="keyword operator class php"><span>::</span></span><span class="meta function-call static php"><span>getFilters</span></span><span>(</span><span>),&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support other namespace php"><span class="punctuation separator inheritance php"><span>\</span></span></span><span class="support class php"><span>Twig_SimpleFilter</span></span><span>(</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>localizedcurrency</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>localizedCurrencyFilter</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation definition array end php"><span>)</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta array php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition array end php"><span>)</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type php"><span>function</span></span><span>&nbsp;</span><span class="constant other php"><span>localizedCurrencyFilter</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>number</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>currency</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>null</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>null</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>forceDefault</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>false</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>if</span></span><span>&nbsp;(</span><span class="keyword operator logical php"><span>!</span></span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>forceDefault</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>number</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>/=</span></span><span class="constant numeric php"><span>100</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="meta function-call php"><span>twig_localized_currency_filter</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>number</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>currency</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Edit <strong>app/config/config.yml</strong> change <strong>twig.extension.intl</strong> class from <code>Twig_Extensions_Extension_Intl</code> to <code>AppBundle\Twig\Extension\Intl</code></li>
</ul>
<p><br><br></p>
<h2 id="14-2-decorate-the-translation-service">14.2 Decorate the translation service</h2>
<p>We are requested to create new types of newsletters, christmas, and summer vacation. Right after capturing the business requirements, we ended up with the following translations in <strong>src/AppBundle/Resources/translations/email.en.yml</strong></p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>newsletter_christmas:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>subject:&nbsp;Merry&nbsp;christmas&nbsp;%customer_name%</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;newsletter@site.com</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>newsletter_new_year:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>subject:&nbsp;Happy&nbsp;new&nbsp;year&nbsp;%customer_name%</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;newsletter@site.com</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>newsletter_summer_vacation:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>subject:&nbsp;Are&nbsp;you&nbsp;ready&nbsp;for&nbsp;vacations&nbsp;%customer_name%?</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;newsletter@site.com</span></span></span></div></pre><p>The <strong>from</strong> duplication is obvious here, moreover, if we will need to change the sender, we will have to change it in many places. I would like to have the translations look like this:</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>default_newsletter_sender:&nbsp;newsletter@site.com</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>newsletter_christmas:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>subject:&nbsp;Merry&nbsp;christmas&nbsp;%customer_name%</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;@default_newsletter_sender</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>newsletter_new_year:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>subject:&nbsp;Happy&nbsp;new&nbsp;year&nbsp;%customer_name%</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;@default_newsletter_sender</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>newsletter_summer_vacation:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>subject:&nbsp;Are&nbsp;you&nbsp;ready&nbsp;for&nbsp;vacations&nbsp;%customer_name%?</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;@default_newsletter_sender</span></span></span></div></pre><p>Unfortunately, this feature is not supported by the Symfony translation component. We will need to override the translator service to add it.</p>
<p>This time, we will introduce some TDD (Test Driven Development) The concept is very simple, don&#39;t write any new code until you have at least one failing test. Let&#39;s start by writing our first test.</p>
<ul>
<li>Create <strong>src/AppBundle/Tests/Service/TranslatorTest.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Tests</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Controller</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Bundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>FrameworkBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Test</span><span class="punctuation separator inheritance php"><span>\</span></span><span>WebTestCase</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>TranslatorTest</span></span><span>&nbsp;</span><span class="storage modifier extends php"><span>extends</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>WebTestCase</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setUp</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type php"><span>static</span></span><span class="keyword operator class php"><span>::</span></span><span class="meta function-call static php"><span>bootKernel</span></span><span>(</span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>testTranslate</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translator</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="storage type php"><span>static</span></span><span class="keyword operator class php"><span>::</span></span><span class="variable other class php"><span class="punctuation definition variable php"><span>$</span></span><span>kernel</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getContainer</span></span><span>(</span><span>)</span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>get</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>translator.default</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>from</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>trans</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>confirmation.from</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="meta array empty php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="punctuation definition array end php"><span>)</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>email</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>en</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>assertEquals</span></span><span>(</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>orders@site.com</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>from</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<p>We will use phpunit for unit tests, to run this test, run</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;phpunit&nbsp;-c&nbsp;app&nbsp;src/AppBundle/Tests/Service/TranslatorTest.php</span></span></div><div class="line"><span class="source shell"><span>PHPUnit&nbsp;3.7.28&nbsp;by&nbsp;Sebastian&nbsp;Bergmann.</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>Configuration&nbsp;</span><span class="support function builtin shell"><span>read</span></span><span>&nbsp;from&nbsp;/home/ubuntu/web/symfony-tutorial/app/phpunit.xml.dist</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span class="support function builtin shell"><span>.</span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>Time:&nbsp;168&nbsp;ms,&nbsp;Memory:&nbsp;4.25Mb</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>OK&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>1&nbsp;</span><span class="support function builtin shell"><span>test</span></span><span>,&nbsp;1&nbsp;assertion</span><span class="punctuation definition subshell shell"><span>)</span></span></span></span></div></pre>
<p>Next step, is to write the test that asserts our desired behaviour. Edit <strong>TranslatorTest.php</strong> and add the following test.</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>public&nbsp;function&nbsp;testTranslateWithReference()&nbsp;{</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>$translator&nbsp;=&nbsp;static::$kernel-&gt;getContainer()-&gt;get(&#39;translator.default&#39;);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;$from&nbsp;=&nbsp;$translator-&gt;trans(&#39;newsletter_christmas.from&#39;,&nbsp;array(),&nbsp;&#39;email&#39;,&nbsp;&#39;en&#39;);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;$defaultFrom&nbsp;=&nbsp;$translator-&gt;trans(&#39;default_newsletter_sender&#39;,&nbsp;array(),&#39;email&#39;,&#39;en&#39;);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;assertEquals($defaultFrom,&nbsp;$from);</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>}</span></span></span></div></pre><p>Let&#39;s run the test again</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;phpunit&nbsp;-c&nbsp;app&nbsp;src/AppBundle/Tests/Service/TranslatorTest.php</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>PHPUnit&nbsp;3.7.28&nbsp;by&nbsp;Sebastian&nbsp;Bergmann.</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Configuration&nbsp;read&nbsp;from&nbsp;/home/ubuntu/web/symfony-tutorial/app/phpunit.xml.dist</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>.F</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Time:&nbsp;229&nbsp;ms,&nbsp;Memory:&nbsp;4.50Mb</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>There&nbsp;was&nbsp;1&nbsp;failure:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>1)&nbsp;AppBundle\Tests\Controller\TranslatorTest::testTranslateWithReference</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Failed&nbsp;asserting&nbsp;that&nbsp;two&nbsp;strings&nbsp;are&nbsp;equal.</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>---&nbsp;Expected</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>+++&nbsp;Actual</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>@@&nbsp;@@</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>-&#39;newsletter@site.com&#39;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>+&#39;@default_newsletter_sender&#39;</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>/home/ubuntu/web/symfony-tutorial/src/AppBundle/Tests/Service/TranslatorTest.php:24</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>FAILURES!</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Tests:&nbsp;2,&nbsp;Assertions:&nbsp;2,&nbsp;Failures:&nbsp;1.</span></span></span></div></pre><p>Now we have set a specific goal, our implementation is done when <strong>testTranslateWithReference</strong> will succeed.</p>
<ul>
<li>Create <strong>src/AppBundle/Service/Translator.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Service</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Translation</span><span class="punctuation separator inheritance php"><span>\</span></span><span>TranslatorBagInterface</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Translation</span><span class="punctuation separator inheritance php"><span>\</span></span><span>TranslatorInterface</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>Translator</span></span><span>&nbsp;</span><span class="storage modifier implements php"><span>implements</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>TranslatorInterface</span></span></span><span>,&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>TranslatorBagInterface</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;TranslatorInterface</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translator</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="support function magic php"><span>__construct</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>TranslatorInterface</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translator</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translator</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>trans</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>id</span></span></span><span>,</span><span class="meta function argument array php"><span>&nbsp;</span><span class="storage type php"><span>array</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parameters</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="punctuation definition array end php"><span>)</span></span></span><span>,</span><span class="meta function argument default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span><span class="keyword operator assignment php"><span>=</span></span><span class="constant language php"><span>null</span></span></span><span>,</span><span class="meta function argument default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span class="keyword operator assignment php"><span>=</span></span><span class="constant language php"><span>null</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translated</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>trans</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>id</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parameters</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>if</span></span><span>&nbsp;(</span><span class="support function string php"><span>strpos</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translated</span></span><span>,&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>@</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>)&nbsp;</span><span class="keyword operator assignment php"><span>=</span><span>=</span><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>0</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>id</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="support function string php"><span>substr</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translated</span></span><span>,&nbsp;</span><span class="constant numeric php"><span>1</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translated</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>trans</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>id</span></span><span>,</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parameters</span></span><span>,</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span><span>,</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translated</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="support function magic php"><span>__call</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>name</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="support function funchand php"><span>call_user_func_array</span></span><span>(</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>name</span></span><span class="punctuation definition array end php"><span>)</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>arguments</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getLocale</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getLocale</span></span><span>(</span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setLocale</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>setLocale</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type php"><span>function</span></span><span>&nbsp;</span><span class="constant other php"><span>transChoice</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>id</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>number</span></span><span>,&nbsp;</span><span class="storage type php"><span>array</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parameters</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="meta array empty php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="punctuation definition array end php"><span>)</span></span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>null</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>null</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>transChoice</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>id</span></span><span>,</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>number</span></span><span>,</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>parameters</span></span><span>,</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span><span>,</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getCatalogue</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>null</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>translator</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getCatalogue</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Edit <strong>src/AppBundle/Resources/config/services.yml</strong> and add the following service definition.</li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>app.translator:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>class:&nbsp;AppBundle\Service\Translator</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;decorates:&nbsp;translator.default</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;arguments:&nbsp;[&quot;@app.translator.inner&quot;]</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;public:&nbsp;false</span></span></span></div></pre><p><br><br></p>
<h2 id="14-3-custom-translation-loader">14.3 Custom translation loader</h2>
<p>We just got new requirements. We need the email related translations to be saved in MySQL database. So we will need to get rid of <strong>src/AppBundle/Resources/translations/email.en.yml</strong> and have those translations in the database. So go ahead and delete that file.</p>
<p>First, let&#39;s create the translations table and populate it with initial data.</p>
<pre class="editor-colors lang-sql"><div class="line"><span class="source sql"><span class="meta create sql"><span class="keyword other create sql"><span>CREATE</span></span><span>&nbsp;</span><span class="keyword other sql"><span>TABLE</span></span><span>&nbsp;`</span><span class="entity name function sql"><span>translation_message</span></span><span>`</span></span><span>&nbsp;(</span></span></div><div class="line"><span class="source sql"><span>&nbsp;&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>id`</span></span><span>&nbsp;</span><span class="storage type sql"><span>int</span></span><span>(</span><span class="constant numeric sql"><span>11</span></span><span>)&nbsp;</span><span class="keyword other DDL create II sql"><span>NOT&nbsp;NULL</span></span><span>&nbsp;AUTO_INCREMENT,</span></span></div><div class="line"><span class="source sql"><span>&nbsp;&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>&nbsp;</span><span class="storage type sql"><span>varchar</span></span><span>(</span><span class="constant numeric sql"><span>255</span></span><span>)</span><span>&nbsp;DEFAULT&nbsp;</span><span class="keyword other DDL create II sql"><span>NULL</span></span><span>,</span></span></div><div class="line"><span class="source sql"><span>&nbsp;&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>&nbsp;</span><span class="storage type sql"><span>varchar</span></span><span>(</span><span class="constant numeric sql"><span>2</span></span><span>)</span><span>&nbsp;DEFAULT&nbsp;</span><span class="keyword other DDL create II sql"><span>NULL</span></span><span>,</span></span></div><div class="line"><span class="source sql"><span>&nbsp;&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>&nbsp;longtext,</span></span></div><div class="line"><span class="source sql"><span>&nbsp;&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>&nbsp;</span><span class="storage type sql"><span>varchar</span></span><span>(</span><span class="constant numeric sql"><span>255</span></span><span>)</span><span>&nbsp;DEFAULT&nbsp;</span><span class="keyword other DDL create II sql"><span>NULL</span></span><span>,</span></span></div><div class="line"><span class="source sql"><span>&nbsp;&nbsp;</span><span class="storage modifier sql"><span>PRIMARY&nbsp;KEY</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>id`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span>);</span></span></div><div class="line"><span class="source sql"><span>&nbsp;</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>default_newsletter_sender&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>newsletter@site.com&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>confirmation.text&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,</span></span></div><div class="line"><span class="source sql"><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>Thank&nbsp;you&nbsp;%customerName%,&nbsp;your&nbsp;order&nbsp;number&nbsp;%orderNumber%&nbsp;is&nbsp;being&nbsp;processed.&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>confirmation.subject&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>Order&nbsp;confirmation&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>confirmation.from&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>orders@site.com&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>newsletter_christmas.subject&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>Merry&nbsp;christmas&nbsp;%customer_name%&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>newsletter_christmas.from&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>@default_newsletter_sender&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>newsletter_new_year.subject&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>Happy&nbsp;new&nbsp;year&nbsp;%customer_name%&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>newsletter_christmas.from&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>@default_newsletter_sender&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>newsletter_summer_vacation.subject&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,</span></span></div><div class="line"><span class="source sql"><span>&nbsp;&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>Are&nbsp;you&nbsp;ready&nbsp;for&nbsp;vacations&nbsp;%customer_name%?&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML sql"><span>INSERT&nbsp;INTO</span></span><span>&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>symfony`</span></span><span>.</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>translation_message`</span></span><span>&nbsp;(</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>key`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>locale`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>value`</span></span><span>,&nbsp;</span><span class="string quoted other backtick sql"><span class="punctuation definition string begin sql"><span>`</span></span><span>domain`</span></span><span>)</span></span></div><div class="line"><span class="source sql"><span class="keyword other DML II sql"><span>VALUES</span></span><span>&nbsp;(</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>newsletter_summer_vacation.from&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>en&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>@default_newsletter_sender&#39;</span></span><span>,&nbsp;</span><span class="string quoted single sql"><span class="punctuation definition string begin sql"><span>&#39;</span></span><span>email&#39;</span></span><span>);</span></span></div></pre>
<p>Next, we need to create the corresponding entity.</p>
<ul>
<li>Create <strong>src/AppBundle/Entity/TranslationMessage.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Doctrine</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Mapping</span></span><span>&nbsp;</span><span class="keyword other use-as php"><span>as</span></span><span>&nbsp;</span><span class="support other namespace use-as php"><span>ORM</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;*&nbsp;Vendor</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;*&nbsp;@ORM\Table(name=&quot;translation_message&quot;)</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;*&nbsp;@ORM\Entity</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>TranslationMessage</span></span><span>&nbsp;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>const</span></span><span>&nbsp;</span><span class="constant other php"><span>REPOSITORY</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>AppBundle:TranslationMessage</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;integer</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(name=&quot;id&quot;,&nbsp;type=&quot;integer&quot;,&nbsp;nullable=false)</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Id</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\GeneratedValue(strategy=&quot;IDENTITY&quot;)</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>id</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;string</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(name=&quot;key&quot;,&nbsp;type=&quot;string&quot;,&nbsp;nullable=true)</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>key</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;string</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(name=&quot;locale&quot;,&nbsp;type=&quot;string&quot;,&nbsp;length=2,&nbsp;nullable=true)</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;string</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(name=&quot;value&quot;,&nbsp;type=&quot;text&quot;,&nbsp;nullable=true)</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>value</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;string</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(name=&quot;domain&quot;,&nbsp;type=&quot;string&quot;,&nbsp;nullable=true)</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getId</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>id</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getKey</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>key</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getLocale</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>locale</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getValue</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>value</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>getDomain</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>domain</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setKey</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>key</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>key</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>key</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setLocale</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>locale</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setValue</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>value</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>value</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>value</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>setDomain</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>domain</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Create <strong>src/AppBundle/Translation/DoctrineLoader.php</strong></li>
</ul>
<pre class="editor-colors lang-php"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta namespace php"><span class="keyword other namespace php"><span>namespace</span></span><span>&nbsp;</span><span class="entity name type namespace php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Translation</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>AppBundle</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Entity</span><span class="punctuation separator inheritance php"><span>\</span></span><span>TranslationMessage</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Doctrine</span><span class="punctuation separator inheritance php"><span>\</span></span><span>ORM</span><span class="punctuation separator inheritance php"><span>\</span></span><span>EntityManager</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Translation</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Loader</span><span class="punctuation separator inheritance php"><span>\</span></span><span>LoaderInterface</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta use php"><span class="keyword other use php"><span>use</span></span><span>&nbsp;</span><span class="support other namespace use php"><span>Symfony</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Component</span><span class="punctuation separator inheritance php"><span>\</span></span><span>Translation</span><span class="punctuation separator inheritance php"><span>\</span></span><span>MessageCatalogue</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta class php"><span class="storage type class php"><span>class</span></span><span>&nbsp;</span><span class="entity name type class php"><span>DoctrineLoader</span></span><span>&nbsp;</span><span class="storage modifier implements php"><span>implements</span></span><span>&nbsp;</span><span class="meta other inherited-class php"><span class="entity other inherited-class php"><span>LoaderInterface</span></span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block documentation phpdoc php"><span class="punctuation definition comment php"><span>/**</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="keyword other phpdoc php"><span>@var</span></span><span>&nbsp;EntityManager</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="comment block documentation phpdoc php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment php"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>private</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>manager</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="support function magic php"><span>__construct</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument typehinted php"><span class="support class php"><span>EntityManager</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>manager</span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>manager</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="meta function php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier php"><span>public</span></span><span>&nbsp;</span><span class="storage type function php"><span>function</span></span><span>&nbsp;</span><span class="entity name function php"><span>load</span></span><span class="punctuation definition parameters begin php"><span>(</span></span><span class="meta function arguments php"><span class="meta function argument no-default php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>resource</span></span></span><span>,</span><span class="meta function argument no-default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span></span><span>,</span><span class="meta function argument default php"><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>messages</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span></span></span><span class="punctuation definition parameters end php"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>repository</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>this</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="variable other property php"><span>manager</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getRepository</span></span><span>(</span><span class="support class php"><span>TranslationMessage</span></span><span class="keyword operator class php"><span>::</span></span><span class="constant other class php"><span>REPOSITORY</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>messages</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>repository</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>findBy</span></span><span>(</span><span class="meta array php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>locale</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator key php"><span>=&gt;</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span class="punctuation definition array end php"><span>)</span></span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>catalogue</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="keyword other new php"><span>new</span></span><span>&nbsp;</span><span class="support class php"><span>MessageCatalogue</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>locale</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translations</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="meta array empty php"><span class="support function construct php"><span>array</span></span><span class="punctuation definition array begin php"><span>(</span></span><span class="punctuation definition array end php"><span>)</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>foreach</span></span><span>&nbsp;(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>messages</span></span><span>&nbsp;</span><span class="keyword operator logical php"><span>as</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span>)&nbsp;</span><span class="punctuation section scope begin php"><span>{</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translations</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getKey</span></span><span>(</span><span>)</span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>message</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>getValue</span></span><span>(</span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>catalogue</span></span><span class="keyword operator class php"><span>-&gt;</span></span><span class="meta function-call object php"><span>add</span></span><span>(</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>translations</span></span><span>,&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>domain</span></span><span>)</span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control php"><span>return</span></span><span>&nbsp;</span><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>catalogue</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="punctuation section scope end php"><span>}</span></span></span></span></span></div></pre>
<ul>
<li>Edit <strong>app/config/config.yml</strong> and add the following service definition</li>
</ul>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>app.translation.doctrine_loader:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>class:&nbsp;AppBundle\Translation\DoctrineLoader</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;arguments:&nbsp;[@doctrine.orm.default_entity_manager]</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;tags:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>-&nbsp;{name:&nbsp;&#39;translation.loader&#39;,&nbsp;alias:&nbsp;&#39;doctrine&#39;}</span></span></span></div></pre><ul>
<li>Create an empty file <strong>app/Resources/translations/email.en.doctrine</strong></li>
</ul>
<p><br><br><br><br></p>
<h2 id="14-4-doctrine-second-level-cache">14.4 Doctrine second level cache</h2>
<p>Browse <a href="http://symfony.local/app_dev.php/country/">http://symfony.local/app_dev.php/country/</a> and inspect the Doctrine tab in the profiler. You will see the query <code>SELECT t0.id AS id_1, t0.code AS code_2, t0.name AS name_3, t0.currency AS currency_4 FROM country t0</code></p>
<p>The countries list won&#39;t change very often. To avoid querying the database every time, we can configure a second level cache for the Country entity.</p>
<ul>
<li><p>Edit <strong>app/config/doctrine.yml</strong>, under doctrine.orm add</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>second_level_cache:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;</span><span class="meta paragraph text"><span>regions:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>app:</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>cache_driver:&nbsp;redis</span></span></span></div></pre></li>
<li><p>Edit <strong>src/AppBundle/Entity/Country.php</strong> and add <code>@ORM\Cache(usage=&quot;READ_ONLY&quot;, region=&quot;app&quot;</code> to the entity annotations.</p>
</li>
</ul>
<p>Done, let&#39;s browse <a href="http://symfony.local/app_dev.php/country/">http://symfony.local/app_dev.php/country/</a> again, notice the new 2l cache tab in the profiler.</p>
<p><img src="/home/skafandri/symfony/book/2lcache-before.png"></p>
<p>refresh the page and inspect the profiler again</p>
<p><img src="/home/skafandri/symfony/book/2lcache-after.png"></p>
<p><br><br></p>
<h2 id="14-5-exercises">14.5 Exercises</h2>
<ol>
<li>Create an asynchronous event. When an asynchronous event is dispatched, serialize it and publish it to the <strong>event</strong> exchange with the <strong>event</strong> routing key.<br>Create an event consumer that will dispatch the event after flagging it as redispatched.</li>
<li>Add an encryptable asynchronous even. So the event will be encrypted before being be published to the exchange.</li>
<li>Let the user define their own encryption/decryption service.</li>
</ol></body>
</html>
